(this.webpackJsonpkidsland=this.webpackJsonpkidsland||[]).push([[0],{624:function(e,t,n){},656:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(19),r=n.n(i),o=(n(221),n(31)),s=n(38),l=n(693),u=n(225),d=n(4),j=function(e){var t=e.label;return Object(d.jsxs)("div",{style:{display:"flex",flex:1,justifyContent:"center",alignItems:"center"},children:[Object(d.jsx)(l.a,{}),Object(d.jsx)(u.a,{style:{marginLeft:12},children:t})]})},m=n(9),b=(n(217),n(154)),h=n(155),f=n(168),v=n(166),p=(n(657),n(738)),O=n(725),x=n(658),y=n(729),g=n(749),w=n(338),C=n(750),D=n(58),S=n(26),k=n(739),E=n(740),R=n(15),T=n(28),I=n(69),A=n(724),F=n(746),z=n(18),M=n(726),L=n(51),W=n.n(L),B=n(65),N=n(697),_=n(745),P=n(167),K=n(743),U=n(63),H=n.n(U),V=n(332),J={apiKey:"AIzaSyDFjBJKK27KVIOSVHuAfsTxxsBv1Eo8Vgs",authDomain:"abc-best-services.firebaseapp.com",databaseURL:"https://abc-best-services-default-rtdb.firebaseio.com",projectId:"abc-best-services",storageBucket:"abc-best-services.appspot.com",messagingSenderId:"868747617375",appId:"1:868747617375:web:119d70071c12bc539ea7ea"},Y=n.n(V)()().browser.name,G=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).VAPID_PUBLIC_KEY,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).API_URL),q=new P.a,Z=Object(K.a)(1e3).pipe(Object(N.a)((function(){return(new Date).getTime()})),Object(_.a)()),Q=function(){var e=Object(a.useState)((new Date).getTime()),t=Object(T.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=Z.subscribe((function(e){c(e)}));return function(){return e.unsubscribe()}}),[]),n},X=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current&&t.current.resetAfterIndex(0)}),[e]),t},$=function(e){var t="email:".concat(e),n="userData-".concat(t);return Object(o.useFirestoreConnect)((function(){return null!==e?[{collection:"emails",doc:e,storeAs:n}]:[]})),Object(s.c)((function(t){return null===e?null:t.firestore.data[n]||null}))},ee=new P.a,te="Notification"in window&&"serviceWorker"in window.navigator,ne=n(100),ae=n(12),ce=n(719),ie=n(720),re=n(721),oe=n(722),se=n(723),le=n(704),ue=n(748),de=n(744),je=(n(222),n(169)),me=n(717),be=n(705),he=n(706),fe=n(707),ve=n(708),pe=n(709),Oe=n(710),xe=n(711),ye=n(712),ge=n(713),we=n(714),Ce=n(715),De=n(716),Se=n(698),ke=n(699),Ee=n(700),Re=n(701),Te=n(702),Ie=n(703),Ae=-109,Fe=[Se.a,ke.a,Ee.a,Re.a,Te.a],ze=57/Fe.length,Me=a.forwardRef((function(e,t){var n,a=e.rssiDB,c=Object(je.a)(e,["rssiDB"]);if("number"!==typeof a)console.warn("Missing or invalid rssiDB prop"),n=Ie.a;else{var i=Math.min(Math.max(a,Ae),-53);if(i<Ae||i>-53)throw new Error("Bad bad");n=Fe[Math.floor((i-Ae)/ze)]}return Object(d.jsx)(n,Object(ae.a)(Object(ae.a)({},c),{},{ref:t}))})),Le=function(e){return Object(d.jsx)(le.a,Object(ae.a)(Object(ae.a)({},e),{},{color:"secondary"}))};function We(e,t){switch(e){case"device-created":return"Dispozitiv nou";case"add-cash":return"".concat(t.amount.toString().padStart(3,"\xa0")," RON (cash)");case"add-card":return"".concat(t.amount.toString().padStart(3,"\xa0")," RON (card)");case"add-credit-admin":var n=0!==t.amount?"".concat(t.amount," RON (add credit)"):"Resetare acceptor";return t.isAcknowledged?"".concat(n," \u2705"):n;case"is-busy":return t.isBusy?"Eroare acceptor":"Acceptor in functiune";case"hopper-empty":return t.isEmpty?"Lipsa jetoane":"Jetoane prezente";case"connectivity":return"".concat(t.isOnline?"Online":"Offline");case"startup":return void 0!==t.version?"Start (v".concat(t.version,")"):"Start";case"reset-credit-total":return"Reset total credit";case"case-open":return t.isOpen?"Carcasa deschisa":"Carcasa inchisa";case"signal":return"Semnal GSM ".concat(t.rssiDB," DB");default:return console.log("Unknown type ".concat(e," for id ").concat(t.id)),"Eveniment necunoscut"}}var Be=function(e){var t=e.value,n=e.amount,a=e.style;return Object(d.jsxs)("div",{style:Object(ae.a)(Object(ae.a)({},a),{},{display:"flex",flexDirection:"column",marginRight:4,marginLeft:4}),children:[Object(d.jsx)(u.a,{children:"".concat(t,"RON")}),Object(d.jsx)(u.a,{children:"".concat(n,"x")})]})},Ne=function(e){var t=e.banknotes;return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",marginLeft:4,marginRight:4,marginTop:4,marginBottom:4},children:[Object(d.jsx)(Be,{value:"1",amount:t[1]}),Object(d.jsx)(Be,{value:"5",amount:t[5]}),Object(d.jsx)(Be,{value:"10",amount:t[10]}),Object(d.jsx)(Be,{value:"50",amount:t[50]})]})},_e=function(e){var t=e.event,n=e.style,c=t.type,i=Object(je.a)(t,["type"]),r=function(e,t){switch(e){case"device-created":return be.a;case"add-cash":return he.a;case"add-card":return fe.a;case"is-busy":return t.isBusy?Le:le.a;case"hopper-empty":return t.isEmpty?Le:le.a;case"connectivity":return t.isOnline?ve.a:pe.a;case"startup":return Oe.a;case"reset-credit-total":return xe.a;case"add-credit-admin":return 0!==t.amount?ye.a:xe.a;case"case-open":return t.isOpen?ge.a:we.a;case"signal":return function(){return Object(d.jsx)(Me,{rssiDB:t.rssiDB})};default:return console.error("Missing icon ".concat(e," for id ").concat(t.id)),Ce.a}}(c,i),o=function(e,t){switch(e){case"case-open":return t.isOpen;default:return!1}}(c,i),s=a.useState(null),l=Object(T.a)(s,2),j=l[0],m=l[1];return Object(d.jsxs)("div",{style:Object(ae.a)(Object(ae.a)({},n),{},{display:"flex",alignItems:"center",color:o?"#c60000":void 0}),children:[Object(d.jsx)(r,{}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:We(c,i)}),"add-cash"===t.type||"add-card"===t.type&&null!==t.banknotes?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(x.a,{onClick:function(e){m(e.currentTarget)},children:Object(d.jsx)(De.a,{})}),Object(d.jsx)(me.a,{transitionDuration:0,open:null!==j,anchorEl:j,onClose:function(){m(null)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:Object(d.jsx)(Ne,{banknotes:t.banknotes})})]}):null]})};delete Intl.RelativeTimeFormat,n(534),n(538),delete Intl.PluralRules,n(539),n(543);var Pe,Ke=new Intl.PluralRules("ro",{type:"cardinal"}),Ue=new Intl.RelativeTimeFormat("ro",{numeric:"auto"}),He=new Intl.DateTimeFormat("ro",{minute:"numeric",hour:"numeric"}),Ve=new Intl.DateTimeFormat("ro",{month:"long"}),Je=new Intl.DateTimeFormat("ro",{month:"long",year:"numeric"}),Ye=new Intl.DateTimeFormat("ro",{day:"numeric",month:"long"}),Ge=new Intl.DateTimeFormat("ro",{day:"numeric",month:"long",year:"numeric"}),qe=new Intl.DateTimeFormat("ro",{weekday:"long"}),Ze=function(e){return Ke.select(e)},Qe=function(e){switch(Ze(e)){case"one":return"".concat(e," dispozitiv selectat");case"few":return"".concat(e," dispozitive selectate");case"other":return"".concat(e," de dispozitive selectate");default:throw new Error}},Xe=function(e){switch(Ze(e)){case"one":return"".concat(e," utilizator selectat");case"few":return"".concat(e," utilizatori selectati");case"other":return"".concat(e," de utilizatori selectati");default:throw new Error}},$e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getTime(),n=e-t,a=n/1e3,c=a/60;if(Math.abs(c)<1)return Ue.format(Math.trunc(a),"second");var i=c/60;if(Math.abs(i)<1)return Ue.format(Math.trunc(c),"minute");var r=i/24;if(Math.abs(r)<1)return Ue.format(Math.trunc(i),"hour");var o=r/(365/12);if(Math.abs(o)<1)return Ue.format(Math.trunc(r),"day");var s=o/12;return Math.abs(s)<1?Ue.format(Math.trunc(o),"month"):Ue.format(Math.trunc(s),"year")},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(new Date).getTime(),n=new Date(e);n.setHours(0,0,0,0);var a=n.getTime(),c=a-t,i=c/1e3,r=i/60,o=r/60,s=o/24,l=s/(365/12);if(Math.abs(l)<1)return Ue.format(Math.trunc(s),"day");var u=l/12;return Math.abs(u)<1?Ue.format(Math.trunc(l),"month"):Ue.format(Math.trunc(u),"year")},tt=(new Date).getFullYear(),nt=function(e){var t=new Date(e);return(t.getFullYear()===tt?Ve:Je).format(t)},at=function(e){var t=new Date(e);return qe.format(t)},ct=function(e){var t=new Date(e);return(t.getFullYear()===tt?Ye:Ge).format(t)},it=function(e){var t=new Date(e);return He.format(t)},rt=function(e){var t=new Date(e);return"".concat(ct(t)," ").concat(He.format(t))},ot=function(e){var t=e.timestamp,n=e.style,a=Q();return Object(d.jsxs)("div",{style:Object(ae.a)(Object(ae.a)({},n),{},{display:"flex",flexDirection:"column",justifyContent:"center"}),children:[Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:$e(t,a)}),Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:rt(t)})]})},st=[],lt=function(e){switch(e){case"name":case"isBusy":return!1;default:return!0}},ut=Object(s.b)((function(e){return{auth:e.firebase.auth}}))((function(e){e.devices;var t=e.onDeviceClicked,n=e.selected,c=(e.setSelected,e.selectionLabel),i=void 0===c?"":c,r=(e.auth,a.useState("name")),o=Object(T.a)(r,2),s=o[0],l=o[1],j=a.useState(lt(s)),m=Object(T.a)(j,2),b=m[0],h=m[1],f=a.useState([]),v=Object(T.a)(f,2),p=v[0],O=v[1],x=a.useState(!1),y=Object(T.a)(x,2),g=(y[0],y[1]),w=window.location.href.includes("local")?"http://localhost:5000":"https://nameless-coast-52007.herokuapp.com";H.a.get(w+"/api/devices").then((function(e){O(e.data.data)}));var C=[{key:"name",label:"Denumire"},{key:"isBusy",label:"Stare dispozitiv"},{key:"lastEvent",label:"Ultimul Eveniment",span:2}],D=(new Set(n),function(e){return t?function(){return t(e)}:null});return Object(d.jsxs)(ce.a,{children:[Object(d.jsx)(ie.a,{children:Object(d.jsx)(re.a,{children:[{key:"isSelected",label:i}].concat(C).map((function(e,t){var n=e.key,a=e.label,c=e.span,i=void 0===c?1:c;return Object(d.jsx)(oe.a,{colSpan:i,align:t===C.length-1?"center":"inherit",children:Object(d.jsx)(ue.a,{active:s===n,direction:(s===n?b:lt(n))?"asc":"desc",onClick:function(){return function(e){s===e?h((function(e){return!e})):(l(e),h(lt(e)))}(n)},children:a})},n)}))})}),Object(d.jsx)(se.a,{children:p.map((function(e){var t=!!st.includes(e.Device);return Object(d.jsxs)(re.a,{hover:!0,selected:t,to:"/device/".concat(e.Device),children:[Object(d.jsx)(oe.a,{padding:"checkbox",onClick:function(){st.push(e.Device),g(!0)},children:Object(d.jsx)(de.a,{checked:t})}),Object(d.jsx)(oe.a,{onClick:D(e.Device),children:Object(d.jsx)(u.a,{noWrap:!0,children:e.name})}),Object(d.jsx)(oe.a,{onClick:D(e.Device),padding:"none",children:Object(d.jsx)(_e,{event:e.lastEvent})}),Object(d.jsx)(oe.a,{onClick:D("id"),padding:"none"})]},e.Device)}))})]})})),dt=Object(A.a)((function(e){return{highlight:{color:e.palette.secondary.main,backgroundColor:Object(z.d)(e.palette.secondary.light,.85)}}})),jt=Object(I.b)(S.g)((function(e){var t,n=e.history,c=(e.authEmail,a.useState(new Set)),i=Object(T.a)(c,2),r=i[0],o=i[1],s=r.size>0,l=dt();t=s,Object(a.useEffect)((function(){if(t){var e=function(e){e.preventDefault(),e.returnValue=""};return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}}}),[t]);return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[Object(d.jsxs)(O.a,{className:s?l.highlight:void 0,children:[Object(d.jsx)(u.a,{variant:"h6",id:"tableTitle",children:s?Qe(r.size):"Dispozitive"}),s?Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(F.a,{title:"Sterge evenimente",children:Object(d.jsx)(x.a,{children:Object(d.jsx)(M.a,{})})})}):null]}),Object(d.jsx)(ut,{onDeviceClicked:function(e){return n.push("/device/".concat(e))},selected:Object(R.a)(r),setSelected:function(e,t){o((function(n){var a=new Set(n);return t?a.add(e):a.delete(e),a}))}})]})})),mt=n(741),bt=n(742),ht=n(731),ft=function(){var e=Object(B.a)(W.a.mark((function e(t,n){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.a.post("".concat(G,"/add-credit"),{deviceID:t,amount:n});case 2:q.next(null);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),vt=n(59),pt=n(67),Ot=n(70),xt=function(e){var t=e.timestamp,n=e.style;return Object(d.jsx)("div",{style:Object(ae.a)(Object(ae.a)({},n),{},{display:"flex",flexDirection:"column",justifyContent:"center"}),children:Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:it(t)})})},yt=function(e){var t=e.timestamp,n=e.style,a=Q();return Object(d.jsxs)("div",{style:Object(ae.a)(Object(ae.a)({},n),{},{paddingLeft:16,display:"flex",flexDirection:"column",justifyContent:"center"}),children:[Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:et(t,a)}),Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:ct(t)})]})},gt=function(e){var t=e.event;return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:45,alignItems:"center"},children:[Object(d.jsx)(xt,{hideDate:!0,style:{marginLeft:8,width:40},timestamp:t.timeSync.toMillis()}),Object(d.jsx)(_e,{style:{marginLeft:16,width:180},event:Object(ae.a)({},t)})]})},wt=function(e){var t=e.data,n=e.index,a=e.style,c=t[n];return Object(d.jsxs)("div",{style:a,children:[Object(d.jsx)(yt,{style:{position:"sticky",top:0,background:"#889aff",height:45,zIndex:1},timestamp:c.timestamp}),c.events.map((function(e){return Object(d.jsx)(gt,{event:e},e.id)}))]})},Ct=function(e){return 45+45*e.events.length},Dt=function(e){var t=e.timestamp,n=e.style;Q();return Object(d.jsxs)("div",{style:Object(ae.a)(Object(ae.a)({},n),{},{paddingLeft:16,display:"flex",flexDirection:"column",justifyContent:"center"}),children:[Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:at(t)}),Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:ct(t)})]})},St=function(e){var t=e.timestamp,n=e.amountCash,a=e.amountCard,c=e.style;return Object(d.jsx)("div",{style:Object(ae.a)(Object(ae.a)({},c),{},{paddingLeft:16,display:"flex",flexDirection:"column",justifyContent:"center"}),children:Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:"".concat(nt(t)," - ").concat(n," RON (cash) ").concat(a," RON (card)")})})},kt=function(e){var t=e.timestamp,n=e.amountCash,a=e.amountCard;return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:45,alignItems:"center"},children:[Object(d.jsx)(Dt,{style:{width:60},timestamp:t}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,align:"right",style:{width:50},children:n}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:"\xa0RON (cash)"}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,align:"right",style:{width:50},children:a}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:"\xa0RON (card)"})]})},Et=function(e){var t=e.data,n=e.index,a=e.style,c=t[n];return Object(d.jsxs)("div",{style:a,children:[Object(d.jsx)(St,{style:{position:"sticky",top:0,background:"#889aff",height:45},timestamp:c.timestamp,amountCash:c.amountCash,amountCard:c.amountCard}),c.events.map((function(e){var t=e.timestamp,n=e.amountCash,a=e.amountCard;return Object(d.jsx)(kt,{timestamp:t,amountCash:n,amountCard:a},t)}))]})},Rt=function(e){return 45+45*e.events.length},Tt=function(e){return e.reduceRight((function(e,t){var n=new Date(t.timeSync.toMillis());n.setHours(0,0,0,0);var a=n.getTime(),c=Object(vt.a)(e),i=c[0],r=void 0===i?null:i,o=c.slice(1);if("add-cash"===t.type)return null===r?[{timestamp:a,amountCash:t.amount,amountCard:0}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,amountCash:t.amount,amountCard:0},r].concat(Object(R.a)(o)):[{timestamp:a,amountCash:t.amount+r.amountCash,amountCard:r.amountCard}].concat(Object(R.a)(o));if("add-card"===t.type)return null===r?[{timestamp:a,amountCash:0,amountCard:t.amount}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,amountCash:0,amountCard:t.amount},r].concat(Object(R.a)(o)):[{timestamp:a,amountCash:r.amountCash,amountCard:t.amount+r.amount}].concat(Object(R.a)(o));throw new Error("Unknown event type ".concat(t.type))}),[])},It=function(e){var t=e.timestamp,n=e.amount,a=e.style;return Object(d.jsx)("div",{style:Object(ae.a)(Object(ae.a)({},a),{},{paddingLeft:16,display:"flex",flexDirection:"column",justifyContent:"center"}),children:Object(d.jsx)(u.a,{variant:"subtitle2",noWrap:!0,children:"".concat(nt(t)," - ").concat(n," RON")})})},At=function(e){var t=e.timestamp,n=e.amount;return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:45,alignItems:"center"},children:[Object(d.jsx)(ot,{style:{marginLeft:16,width:170},timestamp:t}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,align:"right",style:{width:50},children:n}),Object(d.jsx)(u.a,{variant:"body2",noWrap:!0,children:"\xa0RON"})]})},Ft=function(e){var t=e.data,n=e.index,a=e.style,c=t[n];return Object(d.jsxs)("div",{style:a,children:[Object(d.jsx)(It,{style:{position:"sticky",top:0,background:"#889aff",height:45},timestamp:c.timestamp,amount:c.amount}),c.events.map((function(e){var t=e.timestamp,n=e.amount;return Object(d.jsx)(At,{timestamp:t,amount:n},t)}))]})},zt=function(e){return 45+45*e.events.length},Mt=function(e){return e.reduceRight((function(e,t){var n=t.timeSync.toMillis(),a=Object(vt.a)(e),c=a[0],i=void 0===c?null:c,r=a.slice(1);return null===i?[{timestamp:n,amount:t.amount}].concat(Object(R.a)(r)):[{timestamp:i.timestamp,amount:t.amount+i.amount}].concat(Object(R.a)(r))}),[])},Lt=n(727),Wt=n(728),Bt=n(730),Nt=function(e){switch(e){case"unsupported":return"Acest browser (".concat(Y,") nu permite notificari");case"denied":return"Notificarile sunt dezactivate din ".concat(Y);case"default":return"Apasati pentru activare notificari";case"granted":return"Notificari active";default:throw new Error("Unknown web push permission ".concat(e))}},_t=function(e){var t=e.event;return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:45,alignItems:"center"},children:[Object(d.jsx)(xt,{hideDate:!0,style:{marginLeft:16,width:50},timestamp:t.timeSync.toMillis()}),Object(d.jsx)(_e,{style:{marginLeft:16,width:180},event:Object(ae.a)({},t)})]})},Pt=function(e){var t=e.data,n=e.index,a=e.style,c=t[n];return Object(d.jsxs)("div",{style:a,children:[Object(d.jsx)(yt,{style:{position:"sticky",top:0,background:"#889aff",height:45},timestamp:c.timestamp}),c.events.map((function(e){return Object(d.jsx)(_t,{event:e},e.id)}))]})},Kt=function(e){return 45+45*e.events.length},Ut=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;return Object(b.a)(this,n),(e=t.call(this)).componentDidMount=function(){Pe=Vt[0].path,Vt.find((function(e){return e.path===Pe})).component;var t=window.location.href.split("/")[4];H.a.get("http://localhost:5000/api/getdeviceevents/".concat(t)).then((function(t){alert(JSON.stringify(t.data.data)),e.setState({sortedEvents:t.data.data})}))},e.onClick=function(){},e.onSigur=function(){},e.handleRoute=function(){window.location.href.split("/")[5]},e.state={sortedEvents:[]},e}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{style:Ht.Flex1,children:[Object(d.jsxs)("div",{style:Ht.Flex2,children:[Object(d.jsxs)("div",{style:Ht.Flex3,children:[Object(d.jsx)(F.a,{title:"title",children:Object(d.jsx)(Me,{rssiDB:"device.rssiDB",style:{paddingTop:24,marginRight:12}})}),Object(d.jsx)(mt.a,{label:"Denumire",value:"device.name",margin:"normal"}),Object(d.jsx)("div",{style:{width:24}}),Object(d.jsx)(mt.a,{label:"Adaugare credit",value:"device.name",defaultValue:"addCreditValue.toString()",margin:"normal"}),Object(d.jsx)(y.a,{onClick:function(){e.onClick()},children:"Adaugare credit"})]}),Object(d.jsxs)("div",{style:Ht.Flex4,children:[Object(d.jsx)(y.a,{onClick:function(){ft("deviceID",0)},children:"    Resetare acceptor    "}),Object(d.jsx)(y.a,{onClick:function(){e.onSigur()},children:"    Resetare credit  "}),Object(d.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:Object(d.jsx)(u.a,{align:"center",variant:"subtitle2",children:"Ultimul reset la credit"})})]})]}),Object(d.jsx)(bt.a,{variant:"scrollable",scrollButtons:"on",value:"activePath",onChange:function(e,t){},children:Vt.map((function(t){var n=t.path,a=t.title;return Object(d.jsx)(ht.a,{onClick:function(){e.handleRoute()},value:n,component:D.b,label:a,to:"/device/cMeucuqYV2b/".concat(n)},Math.random())}))}),Object(d.jsx)(se.a,{children:this.state.sortedEvents.map((function(e){return Object(d.jsxs)(re.a,{hover:!0,selected:!1,to:"/device/".concat(e.Device),children:[Object(d.jsx)(oe.a,{children:Object(d.jsx)(u.a,{noWrap:!0,children:e.syncTime})}),Object(d.jsx)(oe.a,{padding:"none",children:Object(d.jsx)(_e,{event:e.syncTime})}),Object(d.jsx)(oe.a,{padding:"none"})]},e.Device)}))})]})}}]),n}(c.a.Component),Ht={Flex1:{display:"flex",flexDirection:"column",flex:1},Flex2:{display:"flex",justifyContent:"space-between",flexWrap:"wrap"},Flex3:{display:"flex",flexDirection:"row",alignItems:"center",margin:"0 16px"},Flex4:{display:"flex",flexDirection:"row",alignItems:"center",margin:"0 16px"}},Vt=[{component:function(e){var t=e.events,n=function(e){var t=null;return e.reverse().map((function(e){switch(e.type){case"reset-credit-total":return t={1:0,5:0,10:0,50:0},e;case"add-cash":return null===t&&(t={1:0,5:0,10:0,50:0}),t=Object(ae.a)(Object(ae.a)({},t),{},Object(ne.a)({},e.amount,t[e.amount]+1)),Object(ae.a)(Object(ae.a)({},e),{},{banknotes:t});default:return e}})).reverse()}(t).reduceRight((function(e,t){var n=new Date(t.timeSync.toMillis());n.setHours(0,0,0,0);var a=n.getTime(),c=Object(vt.a)(e),i=c[0],r=void 0===i?null:i,o=c.slice(1);return null===r?[{timestamp:a,events:[t]}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,events:[t]},r].concat(Object(R.a)(o)):[{timestamp:a,events:[t].concat(Object(R.a)(r.events))}].concat(Object(R.a)(o))}),[]),a=n.reduce((function(e,t){return e+Ct(t)}),0)/n.length,c=X(t);return Object(d.jsx)("div",{style:{flex:1},children:Object(d.jsx)(pt.a,{children:function(e){var t=e.height,i=e.width;return Object(d.jsx)(Ot.a,{ref:c,width:i,height:t,itemCount:n.length,estimatedItemSize:a,itemSize:function(e){return Ct(n[e])},itemKey:function(e){return n[e].timestamp},itemData:n,children:wt})}})})},title:"Evenimente",path:"events"},{component:function(e){var t=e.events.filter((function(e){var t=e.type;return"add-cash"===t||"add-card"===t})),n=function(e){return e.reduceRight((function(e,t){var n=new Date(t.timeSync.toMillis());n.setDate(1),n.setHours(0,0,0,0);var a=n.getTime(),c=Object(vt.a)(e),i=c[0],r=void 0===i?null:i,o=c.slice(1);if("add-cash"===t.type)return null===r?[{timestamp:a,amountCash:t.amount,amountCard:0,events:[t]}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,amountCash:t.amount,amountCard:0,events:[t]},r].concat(Object(R.a)(o)):[{timestamp:a,amountCash:r.amountCash+t.amount,amountCard:r.amountCard,events:[t].concat(Object(R.a)(r.events))}].concat(Object(R.a)(o));if("add-card"===t.type)return null===r?[{timestamp:a,amountCash:0,amountCard:t.amount,events:[t]}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,amountCash:0,amountCard:t.amount,events:[t]},r].concat(Object(R.a)(o)):[{timestamp:a,amountCash:r.amountCash,amountCard:r.amountCard+t.amount,events:[t].concat(Object(R.a)(r.events))}].concat(Object(R.a)(o));throw new Error("Unknown event type ".concat(t.type))}),[])}(t).map((function(e){var t=e.timestamp,n=e.amountCash,a=e.amountCard,c=e.events;return{timestamp:t,amountCash:n,amountCard:a,events:Tt(c)}})),a=n.reduce((function(e,t){return e+Rt(t)}),0)/n.length,c=X(t);return Object(d.jsx)("div",{style:{flex:1},children:Object(d.jsx)(pt.a,{children:function(e){var t=e.height,i=e.width;return Object(d.jsx)(Ot.a,{ref:c,width:i,height:t,itemCount:n.length,estimatedItemSize:a,itemSize:function(e){return Rt(n[e])},itemKey:function(e){return n[e].timestamp},itemData:n,children:Et})}})})},title:"Raport Bani Lunar",path:"cash-report"},{component:function(e){var t=e.events.filter((function(e){var t=e.type;return"add-cash"===t||"add-card"===t})),n=function(e){return e.reduceRight((function(e,t){var n=new Date(t.timeSync.toMillis());n.setDate(1),n.setHours(0,0,0,0);var a=n.getTime(),c=Object(vt.a)(e),i=c[0],r=void 0===i?null:i,o=c.slice(1);return null===r?[{timestamp:a,amount:t.amount,events:[t]}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,amount:t.amount,events:[t]},r].concat(Object(R.a)(o)):[{timestamp:a,amount:r.amount+t.amount,events:[t].concat(Object(R.a)(r.events))}].concat(Object(R.a)(o))}),[])}(t).map((function(e){var t=e.timestamp,n=e.amount,a=e.events;return{timestamp:t,amount:n,events:Mt(a)}})),a=n.reduce((function(e,t){return e+zt(t)}),0)/n.length,c=X(t);return Object(d.jsx)("div",{style:{flex:1},children:Object(d.jsx)(pt.a,{children:function(e){var t=e.height,i=e.width;return Object(d.jsx)(Ot.a,{ref:c,width:i,height:t,itemCount:n.length,estimatedItemSize:a,itemSize:function(e){return zt(n[e])},itemKey:function(e){return n[e].timestamp},itemData:n,children:Ft})}})})},title:"Raport Bani Tranzactii",path:"cash-transaction"},{component:function(e){var t=e.device,n=Object(s.c)((function(e){var t;return(null===(t=e.firebase)||void 0===t?void 0:t.auth.email)||null})),c=$(n),i=null===c?null:(c.watchedDevices||[]).includes(t.id),r=function(){var e=Object(a.useState)(te?Notification.permission:"unsupported"),t=Object(T.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=ee.subscribe(c);return function(){e.unsubscribe()}}),[]),{notificationPermission:n,triggerPrompt:function(){var e=Object(B.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!te){e.next=5;break}return e.next=3,Notification.requestPermission();case 3:t=e.sent,ee.next(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}(),l=r.notificationPermission,u=r.triggerPrompt,j=Object(o.useFirestore)(),b=Object(d.jsx)(Lt.a,{checked:!0===i,onChange:function(e,a){!function(e){e&&"default"===l&&u();var a=m.b.firestore.FieldValue;j.collection("emails").doc(n).update({watchedDevices:(e?a.arrayUnion:a.arrayRemove)(t.id)})}(a)}}),h=!0===i&&"granted"!==l;return Object(d.jsxs)("div",{children:[Object(d.jsx)(Wt.a,{style:{margin:18},disabled:null===i||h,control:b,label:"Notificari ".concat(i?"active":"inactive")}),h?Object(d.jsx)(y.a,{color:"primary",variant:"contained",onClick:u,disabled:"denied"===l,startIcon:Object(d.jsx)(Bt.a,{}),children:Nt(l)}):null]})},title:"Notificari",path:"notifications"},{component:function(e){var t=function(e){var t="deviceSignal-".concat(e);return Object(o.useFirestoreConnect)((function(){return[{collection:"devices",doc:e,orderBy:[["timeSync","desc"]],subcollections:[{collection:"state"}],storeAs:t}]})),Object(s.c)((function(e){return e.firestore.ordered[t]||[]}))}(e.device.id),n=t.reduceRight((function(e,t){var n=new Date(t.timeSync.toMillis());n.setHours(0,0,0,0);var a=n.getTime(),c=Object(vt.a)(e),i=c[0],r=void 0===i?null:i,o=c.slice(1);return null===r?[{timestamp:a,events:[t]}].concat(Object(R.a)(o)):r.timestamp!==a?[{timestamp:a,events:[t]},r].concat(Object(R.a)(o)):[{timestamp:a,events:[t].concat(Object(R.a)(r.events))}].concat(Object(R.a)(o))}),[]),a=n.reduce((function(e,t){return e+Kt(t)}),0)/n.length,c=X(t);return Object(d.jsx)("div",{style:{flex:1},children:Object(d.jsx)(pt.a,{children:function(e){var t=e.height,i=e.width;return Object(d.jsx)(Ot.a,{ref:c,width:i,height:t,itemCount:n.length,estimatedItemSize:a,itemSize:function(e){return Kt(n[e])},itemKey:function(e){return n[e].timestamp},itemData:n,children:Pt})}})})},title:"Semnal GSM",path:"gsm-signal"}].map((function(e){var t=e.component,n=e.title,a=e.path;return{component:t,title:n,path:a,fullPath:"localhost:3000/device/ekNhZncrnKm/".concat(a)}})),Jt=(Object(o.withFirebase)((function(e){var t=e.firebase;return Object(d.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(d.jsx)(u.a,{style:{marginBottom:12},children:"Acest cont nu are permisione pentru a vizualiza datele"}),Object(d.jsx)(y.a,{variant:"contained",color:"primary",onClick:function(){t.logout()},children:"Log out"})]})})),n(335)),Yt=n(732),Gt=n(747),qt=n(734),Zt=n(735),Qt=n(736),Xt=n(737),$t=n(733),en=function(e){switch(e){case"email":case"isAdmin":return!1;default:return!0}},tn=[{key:"email",label:"Email"},{key:"isAdmin",label:"Administrator"}],nn=Object(A.a)((function(e){return{highlight:{color:e.palette.secondary.main,backgroundColor:Object(z.d)(e.palette.secondary.light,.85)}}})),an=Object(I.b)(S.g,Object(s.b)((function(e){var t;return{emails:(null===(t=e.firestore.ordered.emails)||void 0===t?void 0:t.map((function(e){return{email:e.id,isAdmin:e.isAdmin}})))||null}})),Object(o.firestoreConnect)([{collection:"emails"}]))((function(e){var t=e.emails,n=e.history,c=e.firestore,i=a.useState(!1),r=Object(T.a)(i,2),o=r[0],s=r[1],l=a.useState(!1),m=Object(T.a)(l,2),b=m[0],h=m[1],f=a.useState(""),v=Object(T.a)(f,2),p=v[0],g=v[1],w=function(){s(!1),h(!1)},C=nn(),D=a.useState(new Set),S=Object(T.a)(D,2),k=S[0],E=S[1],I=k.size>0,A=a.useState("email"),z=Object(T.a)(A,2),L=z[0],W=z[1],B=a.useState(en(L)),N=Object(T.a)(B,2),_=N[0],P=N[1];if(null===t)return Object(d.jsx)(j,{label:"Se incarca lista de dispozitive"});var K=function(e){return function(){return n.push("/users/".concat(e))}},U=function(){Object(Jt.isEmail)(p)?(!function(e){c.collection("emails").doc(e).set({isAdmin:!1})}(p),s(!1)):h(!0)};return Object(d.jsxs)("div",{children:[Object(d.jsxs)(O.a,{className:I?C.highlight:void 0,children:[Object(d.jsx)(u.a,{variant:"h6",id:"tableTitle",children:I?Xe(k.size):"Utilizatori"}),I?Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(F.a,{title:"Sterge utilizatori",children:Object(d.jsx)(x.a,{onClick:function(){!function(e){var t=c.batch();e.forEach((function(e){t.delete(c.collection("emails").doc(e))})),t.commit()}(Object(R.a)(k)),E((function(e){var t=new Set(e);return k.forEach((function(e){t.delete(e)})),t}))},children:Object(d.jsx)(M.a,{})})})}):null]}),Object(d.jsxs)(ce.a,{children:[Object(d.jsx)(ie.a,{children:Object(d.jsxs)(re.a,{children:[Object(d.jsx)(oe.a,{}),tn.map((function(e,t){var n=e.key,a=e.label,c=e.span,i=void 0===c?1:c;return Object(d.jsx)(oe.a,{colSpan:i,align:t===tn.length-1?"center":"inherit",children:Object(d.jsx)(ue.a,{active:L===n,direction:(L===n?_:en(n))?"asc":"desc",onClick:function(){return function(e){L===e?P((function(e){return!e})):(W(e),P(en(e)))}(n)},children:a})},n)}))]})}),Object(d.jsx)(se.a,{children:[{email:"princehamzi.mine@gmail.com"},{email:"Female.Email@gmail.com",isAdmin:!0}].map((function(e){var t=e.email,n=e.isAdmin,a=k.has(t);return Object(d.jsxs)(re.a,{hover:!0,selected:a,to:"/device/".concat(t),children:[Object(d.jsx)(oe.a,{padding:"checkbox",onClick:function(){return e=t,void E((function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}));var e},children:Object(d.jsx)(de.a,{checked:a})}),Object(d.jsx)(oe.a,{onClick:K(t),children:Object(d.jsx)(u.a,{noWrap:!0,children:t})}),Object(d.jsx)(oe.a,{onClick:K(t),children:Object(d.jsx)(u.a,{noWrap:!0,children:n?"is admin":""})})]},t)}))})]}),Object(d.jsx)(Yt.a,{color:"primary",style:{position:"absolute",right:16,bottom:16},onClick:function(){s(!0)},children:Object(d.jsx)($t.a,{})}),Object(d.jsxs)(Gt.a,{open:o,onClose:w,children:[Object(d.jsx)(qt.a,{children:"Adaugare user"}),Object(d.jsxs)(Zt.a,{children:[Object(d.jsx)(Qt.a,{children:"Va rog sa adaugati o adresa de email asociata cu un cont Google"}),Object(d.jsx)(mt.a,{error:b,helperText:b?"email invalid":void 0,onChange:function(e){var t=e.target;g(t.value),h(!1)},onKeyDown:function(e){13===e.keyCode&&(U(),e.preventDefault())},autoFocus:!0,margin:"dense",id:"name",label:"Adresa Email",type:"email",fullWidth:!0})]}),Object(d.jsxs)(Xt.a,{children:[Object(d.jsx)(y.a,{onClick:w,children:"Anulare"}),Object(d.jsx)(y.a,{onClick:U,color:"primary",children:"Adaugare"})]})]})]})})),cn=function(e){var t=e.email,n=function(e){var t=$(e);return(null===t||void 0===t?void 0:t.isAdmin)||!1}(t),a=(Object(o.useFirestoreConnect)((function(){return[{collection:"devices",storeAs:"allDevices"}]})),Object(s.c)((function(e){return e.firestore.ordered.allDevices||null}))),c=Object(o.useFirestore)();if(null===a)return Object(d.jsx)(j,{label:"Se incarca lista de dispozitive"});var i=Object(d.jsx)(de.a,{checked:n,onChange:function(e){var n=e.target;c.collection("emails").doc(t).update({isAdmin:n.checked})}});return Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(d.jsx)(u.a,{style:{margin:"0 16px"},children:"Email: '".concat(t,"'")}),Object(d.jsx)(Wt.a,{control:i,label:"Administrator"})]}),Object(d.jsx)(ut,{selectionLabel:"Acces permis",devices:a,selected:[1,2,3].map((function(e){return e.id})),setSelected:function(e,n){c.collection("devices").doc(e).update({admins:(n?m.b.firestore.FieldValue.arrayUnion:m.b.firestore.FieldValue.arrayRemove)("email:".concat(t))})}})]})},rn=function(){var e=Object(S.f)().email;return Object(d.jsx)(cn,{email:e})},on=function(e){var t=e.match;return Object(d.jsxs)(S.c,{children:[Object(d.jsx)(S.a,{path:"".concat(t.url,"/:email"),component:rn}),Object(d.jsx)(S.a,{path:"".concat(t.url,"/"),exact:!0,component:an})]})},sn=D.a,ln=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).componentDidMount=function(){},e}return Object(h.a)(n,[{key:"render",value:function(){return Object(d.jsx)(sn,{children:Object(d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(d.jsx)(p.a,{position:"static",children:Object(d.jsxs)(O.a,{children:[Object(d.jsx)(x.a,{component:D.b,to:"/",edge:"start",color:"inherit",children:Object(d.jsx)(k.a,{})}),Object(d.jsx)(x.a,{component:D.b,to:"/users",edge:"start",color:"inherit",children:Object(d.jsx)(E.a,{})}),Object(d.jsx)(u.a,{variant:"h6",style:{flex:1},children:"Awesome App"}),Object(d.jsx)(y.a,{color:"inherit",onClick:function(e){e.currentTarget},children:Object(d.jsx)(g.a,{style:{margin:10,width:24,height:24}})})]})}),Object(d.jsx)(w.a,{keepMounted:!0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null,open:!1,children:Object(d.jsx)(C.a,{onClick:function(){},children:"Log out"})}),Object(d.jsxs)(S.c,{children:[Object(d.jsx)(S.a,{path:"/",exact:!0,component:jt}),Object(d.jsx)(S.a,{path:"/users",component:on}),Object(d.jsx)(S.a,{path:"/device/:id",component:function(e){var t=e.match;return Object(d.jsx)(Ut,{id:t.params.id})}}),Object(d.jsx)(S.a,{component:function(){return"404"}})]})]})})}}]),n}(c.a.Component),un=(n(624),function(){return Object(d.jsx)("div",{className:"App",children:Object(d.jsx)(ln,{})})}),dn=n(336),jn=function(){window.confirm("Se ruleaza o versiune veche a aplicatiei. Apasa OK pentru update.")&&window.location.reload()},mn=(Object(B.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=7;break}return(t=new dn.a("/service-worker.js")).addEventListener("installed",(function(e){e.isUpdate&&jn()})),t.addEventListener("externalactivated",(function(){jn()})),e.next=6,t.register();case 6:return e.abrupt("return",e.sent);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})))(),n(337)),bn=n(165),hn=function(){return"test"},fn=(n(296),n(297),null);Object(B.a)(W.a.mark((function e(){var t,n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===fn){e.next=2;break}return e.abrupt("return",fn);case 2:return t="https:"===window.location.protocol?Object(ae.a)(Object(ae.a)({},J),{},{authDomain:window.location.hostname}):J,fn=m.b.initializeApp(t),n=fn.firestore(),e.next=7,n.enablePersistence({synchronizeTabs:!0});case 7:e.next=10;break;case 10:return e.abrupt("return",m.b);case 12:case"end":return e.stop()}}),e)})))(),m.b.database().ref("/connect").set({connect:!0});var vn=function(){var e=Object(I.a)({firebase:o.firebaseReducer,app:hn,firestore:bn.firestoreReducer}),t=Object(I.c)(e);return t}(),pn=Object(mn.hot)((function(){return Object(d.jsx)(s.a,{store:vn,children:Object(d.jsx)(o.ReactReduxFirebaseProvider,{firebase:m.b,config:{enableLogging:!1},createFirestoreInstance:bn.createFirestoreInstance,dispatch:vn.dispatch,children:Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(un,{}),Object(d.jsx)("style",{dangerouslySetInnerHTML:{__html:"\nhtml, body, #app{\n  height: 100%;\n  width: 100%;\n  margin: 0;\n  display: flex;\n}\n#app > * {\n  min-height: 100%;\n  width: 100%;\n}\n"}})]})})})}));r.a.render(Object(d.jsx)(pn,{}),function(){var e=window.document.getElementById("app");if(null!==e)return e;var t=document.createElement("div");return t.setAttribute("id","app"),document.body.appendChild(t),t}()),window.version=1}},[[656,1,2]]]);
//# sourceMappingURL=main.ef1041c7.chunk.js.map