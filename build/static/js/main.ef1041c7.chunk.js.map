{"version":3,"sources":["loading.jsx","config.js","hooks.js","signal-bar-icon.jsx","event.jsx","translation.js","NewDevice.jsx","day-time.jsx","devices.jsx","devices-container.jsx","user-api.js","time.jsx","day.jsx","device/events.jsx","day-week.jsx","device/cash-monthly.jsx","device/cash-transaction.jsx","i18n.js","device/gsm-signal.jsx","device/notifications.jsx","missing-permission.jsx","users/users.jsx","users/user.jsx","users/index.jsx","DeviceList.jsx","App.js","register-service-worker.js","reducer.js","firebase.js","index.js","store.js"],"names":["label","style","display","flex","justifyContent","alignItems","CircularProgress","Typography","marginLeft","FIREBASE_CONFIG","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","BROWSER_NAME","userAgentParser","browser","name","API_URL","process","VAPID_PUBLIC_KEY","refreshAddCreditSubject","Subject","source","interval","pipe","map","Date","getTime","share","useTime","useState","time","setTime","useEffect","sub","subscribe","newTime","unsubscribe","useResetReactWindowCache","data","ref","useRef","current","resetAfterIndex","useUserData","email","userKey","storeKey","useFirestoreConnect","collection","doc","storeAs","useSelector","state","firestore","notificationPermissionSubject","hasWebPushSupport","window","navigator","MIN_SIGNAL_DB","BAR_ICONS","SignalCellular0Bar","SignalCellular1Bar","SignalCellular2Bar","SignalCellular3Bar","SignalCellular4Bar","SINGLE_BAR_DB","length","React","SignalBarIcon","rssiDB","props","console","warn","UnknownIcon","cappedRssiDB","Math","min","max","Error","floor","BusyTrueIcon","color","formatEvent","type","amount","toString","padStart","message","isAcknowledged","isBusy","isEmpty","isOnline","undefined","version","isOpen","log","id","BanknoteCount","value","flexDirection","marginRight","Banknotes","banknotes","marginTop","marginBottom","event","Icon","NewIcon","AddCashIcon","CreditCard","BusyFalseIcon","OnlineIcon","OfflineIcon","PowerIcon","ResetIcon","AddCreditAdminIcon","LockOpenOutlined","LockOutlined","error","getEventIcon","isWarning","isEventWarning","popoverAnchor","setPopoverAnchor","variant","noWrap","IconButton","onClick","currentTarget","InfoOutlined","Popover","transitionDuration","open","anchorEl","onClose","anchorOrigin","vertical","horizontal","transformOrigin","Intl","RelativeTimeFormat","require","PluralRules","activePath","cardinalRules","relativeTimeFormat","numeric","absoluteTimeFormat","DateTimeFormat","minute","hour","absoluteMonthCurrentYearFormat","month","absoluteMonthOtherYearFormat","year","absoluteDayCurrentYearFormat","day","absoluteDayOtherYearFormat","absoluteDayWeekFormat","weekday","cardinal","count","select","SELECTED_DEVICES","SELECTED_USERS","TIME_RELATIVE","now","deltaMilliseconds","deltaSeconds","deltaMinutes","abs","format","trunc","deltaHours","deltaDays","deltaMonths","deltaYears","DAY_RELATIVE","midnight","setHours","timestamp","CURRENT_YEAR","getFullYear","MONTH_ABSOLUTE","date","DAY_WEEK","DAY_ABSOLUTE","DAY_TIME_ABSOLUTE","TIME_ABSOLUTE","selectedItems","isDefaultAscending","key","connect","auth","firebase","devices","onDeviceClicked","selected","setSelected","selectionLabel","orderBy","setOrderBy","orderAscending","setOrderAscending","sortedDevices","setSortedDevices","setSel","Url","location","href","includes","axios","get","then","res","STATIC_COLUMNS","span","createDeviceOnClick","Set","Table","TableHead","TableRow","idx","TableCell","colSpan","align","TableSortLabel","active","direction","old","toggleOrderBy","TableBody","isSelected","Device","hover","to","padding","push","Checkbox","checked","lastEvent","useStyles","makeStyles","theme","highlight","palette","secondary","main","backgroundColor","lighten","light","compose","withRouter","isActive","history","authEmail","hasSelected","size","classes","cb","e","preventDefault","returnValue","addEventListener","removeEventListener","Toolbar","className","Tooltip","title","EventBusy","set","add","delete","addCredit","deviceID","a","post","next","paddingLeft","DayEvent","height","hideDate","width","timeSync","toMillis","Row","days","index","position","top","background","zIndex","events","getDayLayoutHeight","Month","amountCash","amountCard","months","sumByDay","reduceRight","startOfDay","lastDay","otherDays","sumByTransaction","lastTransaction","webPushPermissionInfo","permission","componentDidMount","screens","path","find","component","deviceId","split","alert","JSON","stringify","setState","sortedEvents","onSigur","handleRoute","Styles","Flex1","Flex2","Flex3","paddingTop","TextField","margin","defaultValue","Button","Flex4","Tabs","scrollButtons","onChange","_","newPath","Tab","Link","random","this","syncTime","Component","flexWrap","lastBanknotes","reverse","addBanknotes","estimatedHeight","reduce","sum","reactWindowListRef","itemCount","estimatedItemSize","itemSize","itemKey","itemData","cashEvents","filter","startOfMonth","setDate","groupByMonths","device","userEmail","userData","isWatched","watchedDevices","Notification","notificationPermission","setNotificationPermission","triggerPrompt","requestPermission","newPermission","useNotificationPermission","firestoreDB","useFirestore","sw","Switch","newValue","newIsWatched","FieldValue","update","arrayUnion","arrayRemove","setIsWatched","cantWatch","FormControlLabel","disabled","control","startIcon","subcollections","ordered","useSignalData","fullPath","withFirebase","logout","columns","emails","isAdmin","firestoreConnect","showAddUser","setShowAddUser","isInvalidEmail","setIsInvalidEmail","newEmail","setNewEmail","closeModal","createViewUserNav","trySubmitEmail","isEmail","addUser","deleteEmails","batch","forEach","commit","deleteUsers","has","Fab","right","bottom","Add","Dialog","DialogTitle","DialogContent","DialogContentText","helperText","target","onKeyDown","keyCode","autoFocus","fullWidth","DialogActions","useIsUserAdmin","allDevices","isAdminCheckbox","admins","MountedUser","useParams","match","url","exact","Users","Router","BrowserRouter","DeviceList","AppBar","edge","Home","SupervisorAccount","Avatar","Menu","keepMounted","getContentAnchorEl","MenuItem","DevicesContainer","params","App","promptReload","confirm","reload","workbox","Workbox","isUpdate","register","firebaseApp","firebaseConfig","protocol","hostname","initializeApp","enablePersistence","synchronizeTabs","connectFirebase","database","store","rootReducer","combineReducers","firebaseReducer","app","appReducer","firestoreReducer","createStore","Main","hot","config","enableLogging","createFirestoreInstance","dispatch","dangerouslySetInnerHTML","__html","ReactDOM","render","currentContainer","document","getElementById","newContainer","createElement","setAttribute","body","appendChild","getAppContainer"],"mappings":"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","file":"static/js/main.ef1041c7.chunk.js","sourcesContent":["import * as React from 'react';\nimport { CircularProgress, Typography } from '@material-ui/core';\n\nexport default ({ label }) => (\n  <div\n    style={{\n      display: 'flex',\n      flex: 1,\n      justifyContent: 'center',\n      alignItems: 'center',\n    }}\n  >\n    <CircularProgress />\n    <Typography style={{ marginLeft: 12 }}>{label}</Typography>\n  </div>\n);\n","import userAgentParser from 'ua-parser-js';\r\nexport var firebaseConfig = {\r\n    apiKey: \"AIzaSyCnD-xueHVA0gwNjBLUu5hlB8x8jhMMgOw\",\r\n    authDomain: \"kidland-5754b.firebaseapp.com\",\r\n    databaseURL: \"https://kidland-5754b-default-rtdb.firebaseio.com\",\r\n    projectId: \"kidland-5754b\",\r\n    storageBucket: \"kidland-5754b.appspot.com\",\r\n    messagingSenderId: \"291891653552\",\r\n    appId: \"1:291891653552:web:19a1a9a416f4201f0ac475\"\r\n  };\r\n  \r\n\r\nexport const FIREBASE_CONFIG = {\r\n    apiKey: \"AIzaSyDFjBJKK27KVIOSVHuAfsTxxsBv1Eo8Vgs\",\r\n    authDomain: \"abc-best-services.firebaseapp.com\",\r\n    databaseURL: \"https://abc-best-services-default-rtdb.firebaseio.com\",\r\n    projectId: \"abc-best-services\",\r\n    storageBucket: \"abc-best-services.appspot.com\",\r\n    messagingSenderId: \"868747617375\",\r\n    appId: \"1:868747617375:web:119d70071c12bc539ea7ea\"\r\n}\r\nexport const IS_PRODUCTION = process.env.NODE_ENV === 'production';\r\nexport const TRANSACTION_DEBOUNCE_INTERVAL = 30000;\r\nexport const DISABLE_NETWORK = false;\r\nexport const BROWSER_NAME = userAgentParser().browser.name;\r\n/* workaround for https://github.com/webpack/webpack/issues/5392 */\r\n/* eslint-disable prefer-destructuring */\r\nexport const VAPID_PUBLIC_KEY = process.env.VAPID_PUBLIC_KEY;\r\nexport const VERSION = 1.0;\r\nexport const API_URL = process.env.API_URL;\r\n/* eslint-enable prefer-destructuring */\r\n","import { share, map } from 'rxjs/operators';\nimport { interval, Subject } from 'rxjs';\nimport { useSelector } from 'react-redux';\nimport { useFirestoreConnect } from 'react-redux-firebase';\nimport { useEffect, useState, useRef } from 'react';\nimport axios from 'axios';\nimport { API_URL } from './config';\n\nexport const refreshAddCreditSubject = new Subject();\n\nexport const refreshAddCreditEvents = () => {\n  refreshAddCreditSubject.next(null);\n};\n\nconst source = interval(1000).pipe(\n  map(() => new Date().getTime()),\n  share()\n);\n\nexport const useTime = () => {\n  const [time, setTime] = useState(new Date().getTime());\n  useEffect(() => {\n    const sub = source.subscribe(newTime => {\n      setTime(newTime);\n    });\n    return () => sub.unsubscribe();\n  }, []);\n  return time;\n};\n\nexport const useLeavePrompt = isActive => {\n  useEffect(() => {\n    if (isActive) {\n      const cb = e => {\n        e.preventDefault();\n        // browsers do not support custom text\n        // https://stackoverflow.com/questions/38879742/is-it-possible-to-display-a-custom-message-in-the-beforeunload-popup\n        e.returnValue = '';\n      };\n      window.addEventListener('beforeunload', cb);\n\n      return () => {\n        window.removeEventListener('beforeunload', cb);\n      };\n    }\n\n    return undefined;\n  }, [isActive]);\n};\n\nexport const useResetReactWindowCache = data => {\n  // https://github.com/bvaughn/react-window/issues/147#issue-414996310\n  const ref = useRef();\n  useEffect(() => {\n    // AutoSizer causes ref not being present on the component mount\n    if (ref.current) {\n      ref.current.resetAfterIndex(0);\n    }\n  }, [data]);\n  return ref;\n};\n\nexport const useUserData = email => {\n  const userKey = `email:${email}`;\n  const storeKey = `userData-${userKey}`;\n  useFirestoreConnect(() => {\n    return email !== null\n      ? [\n          {\n            collection: 'emails',\n            doc: email,\n            storeAs: storeKey,\n          },\n        ]\n      : [];\n  });\n  return useSelector(state => {\n    if (email === null) {\n      return null;\n    }\n    return state.firestore.data[storeKey] || null;\n  });\n};\n\nexport const useSignalData = deviceID => {\n  const storeKey = `deviceSignal-${deviceID}`;\n  useFirestoreConnect(() => [\n    {\n      collection: 'devices',\n      doc: deviceID,\n      orderBy: [['timeSync', 'desc']],\n      subcollections: [{ collection: 'state' }],\n      storeAs: storeKey,\n    },\n  ]);\n  return useSelector(state => {\n    return state.firestore.ordered[storeKey] || [];\n  });\n};\n\nconst notificationPermissionSubject = new Subject();\nconst hasWebPushSupport =\n  'Notification' in window && 'serviceWorker' in window.navigator;\n\nexport const useNotificationPermission = () => {\n  const [notificationPermission, setNotificationPermission] = useState(\n    hasWebPushSupport ? Notification.permission : 'unsupported'\n  );\n  useEffect(() => {\n    const sub = notificationPermissionSubject.subscribe(\n      setNotificationPermission\n    );\n    return () => {\n      sub.unsubscribe();\n    };\n  }, []);\n  return {\n    notificationPermission,\n    triggerPrompt: async () => {\n      if (hasWebPushSupport) {\n        const newPermission = await Notification.requestPermission();\n        notificationPermissionSubject.next(newPermission);\n      }\n    },\n  };\n};\nexport const useIsUserAdmin = email => {\n  const userData = useUserData(email);\n  return userData?.isAdmin || false;\n};\n\nexport const useAuthEmail = () => {\n  return useSelector(state => state.firebase?.auth.email || null);\n};\n\nexport const useLoadUserDevices = email => {\n  const userKey = `email:${email}`;\n  const storeKey = `devices-${userKey}`;\n  useFirestoreConnect(() => [\n    {\n      collection: 'devices',\n      where: [['admins', 'array-contains', userKey]],\n      storeAs: storeKey,\n    },\n  ]);\n  return useSelector(state => state.firestore.ordered[storeKey] || null);\n};\n\nexport const useLoadDeviceAddCreditEvents = deviceID => {\n  const [events, setEvents] = useState([]);\n  const [retryIdx, setRetryIdx] = useState(0);\n  useEffect(() => {\n    const int = setInterval(() => {\n      setRetryIdx(Math.random());\n    }, 5000);\n    const sub = refreshAddCreditSubject.subscribe(() => {\n      setRetryIdx(Math.random());\n    });\n    return () => {\n      clearInterval(int);\n      sub.unsubscribe();\n    };\n  }, []);\n  useEffect(() => {\n    const { CancelToken } = axios;\n    const cancelTokenSource = CancelToken.source();\n    // axios.get(`${API_URL}/add-credit/${deviceID}`, {\n    //     cancelToken: cancelTokenSource.token,\n    //   }).then(it => {\n    //     setEvents(it.data);\n    //   }).catch(e => {});\n\n    return () => {\n      cancelTokenSource.cancel();\n    };\n  }, [deviceID, retryIdx]);\n  return events;\n};\n\nexport const useLoadAllDevices = () => {\n  useFirestoreConnect(() => [\n    {\n      collection: 'devices',\n      storeAs: 'allDevices',\n    },\n  ]);\n  return useSelector(state => state.firestore.ordered.allDevices || null);\n};\n","import * as React from 'react';\nimport {\n  SignalCellular0Bar,\n  SignalCellular1Bar,\n  SignalCellular2Bar,\n  SignalCellular3Bar,\n  SignalCellular4Bar,\n  SignalCellularNull as UnknownIcon,\n} from '@material-ui/icons';\n\nconst MIN_SIGNAL_DB = -109;\nconst MAX_SIGNAL_DB = -53;\n\nconst BAR_ICONS = [\n  SignalCellular0Bar,\n  SignalCellular1Bar,\n  SignalCellular2Bar,\n  SignalCellular3Bar,\n  SignalCellular4Bar,\n];\n\nconst SINGLE_BAR_DB = (MAX_SIGNAL_DB - MIN_SIGNAL_DB + 1) / BAR_ICONS.length;\n\n// workaround to be used in ToolTip, see https://material-ui.com/guides/composition/#caveat-with-refs\nexport default React.forwardRef(({ rssiDB, ...props }, ref) => {\n  let SignalBarIcon;\n  if (typeof rssiDB !== 'number') {\n    console.warn('Missing or invalid rssiDB prop');\n    SignalBarIcon = UnknownIcon;\n  } else {\n    const cappedRssiDB = Math.min(\n      Math.max(rssiDB, MIN_SIGNAL_DB),\n      MAX_SIGNAL_DB\n    );\n    if (cappedRssiDB < MIN_SIGNAL_DB || cappedRssiDB > MAX_SIGNAL_DB) {\n      throw new Error(`Bad bad`);\n    }\n    SignalBarIcon =\n      BAR_ICONS[Math.floor((cappedRssiDB - MIN_SIGNAL_DB) / SINGLE_BAR_DB)];\n  }\n  return <SignalBarIcon {...props} ref={ref} />;\n});\n","import * as React from 'react';\nimport { Typography, IconButton, Popover } from '@material-ui/core';\nimport {\n  Error as BusyFalseIcon,\n  FiberNew as NewIcon,\n  AttachMoney as AddCashIcon,\n  PowerSettingsNew as PowerIcon,\n  Wifi as OnlineIcon,\n  WifiOff as OfflineIcon,\n  RotateLeft as ResetIcon,\n  Help as UnknownIcon,\n  AddCircle as AddCreditAdminIcon,\n  LockOpenOutlined,\n  LockOutlined,\n  CreditCard,\n  InfoOutlined,\n} from '@material-ui/icons';\nimport SignalBarIcon from './signal-bar-icon';\n\n// eslint-disable-next-line react/jsx-props-no-spreading\nconst BusyTrueIcon = props => <BusyFalseIcon {...props} color=\"secondary\" />;\n\nconst isEventWarning = (type, data) => {\n  switch (type) {\n    case 'case-open':\n      return data.isOpen;\n    default:\n      return false;\n  }\n};\nconst getEventIcon = (type, data) => {\n  switch (type) {\n    case 'device-created':\n      return NewIcon;\n    case 'add-cash':\n      return AddCashIcon;\n    case 'add-card':\n      return CreditCard;\n    case 'is-busy':\n      return data.isBusy ? BusyTrueIcon : BusyFalseIcon;\n    case 'hopper-empty':\n      return data.isEmpty ? BusyTrueIcon : BusyFalseIcon;\n    case 'connectivity':\n      return data.isOnline ? OnlineIcon : OfflineIcon;\n    case 'startup':\n      return PowerIcon;\n    case 'reset-credit-total':\n      return ResetIcon;\n    case 'add-credit-admin':\n      if (data.amount !== 0) {\n        return AddCreditAdminIcon;\n      }\n      return ResetIcon;\n    case 'case-open':\n      return data.isOpen ? LockOpenOutlined : LockOutlined;\n    case 'signal':\n      return () => <SignalBarIcon rssiDB={data.rssiDB} />;\n    default:\n      console.error(`Missing icon ${type} for id ${data.id}`);\n      return UnknownIcon;\n  }\n};\nfunction formatEvent(type, data) {\n  switch (type) {\n    case 'device-created':\n      return 'Dispozitiv nou';\n    case 'add-cash':\n      return `${data.amount.toString().padStart(3, '\\xa0')} RON (cash)`;\n    case 'add-card':\n      return `${data.amount.toString().padStart(3, '\\xa0')} RON (card)`;\n    case 'add-credit-admin':\n      const message =\n        data.amount !== 0\n          ? `${data.amount} RON (add credit)`\n          : 'Resetare acceptor';\n      return data.isAcknowledged ? `${message} âœ…` : message;\n    case 'is-busy':\n      return data.isBusy ? 'Eroare acceptor' : 'Acceptor in functiune';\n    case 'hopper-empty':\n      return data.isEmpty ? 'Lipsa jetoane' : 'Jetoane prezente';\n    case 'connectivity':\n      return `${data.isOnline ? 'Online' : 'Offline'}`;\n    case 'startup':\n      if (data.version !== undefined) {\n        return `Start (v${data.version})`;\n      }\n      return `Start`;\n    case 'reset-credit-total':\n      return 'Reset total credit';\n    case 'case-open':\n      return data.isOpen ? 'Carcasa deschisa' : 'Carcasa inchisa';\n    case 'signal':\n      return `Semnal GSM ${data.rssiDB} DB`;\n    default:\n      console.log(`Unknown type ${type} for id ${data.id}`);\n      return 'Eveniment necunoscut';\n  }\n}\nconst BanknoteCount = ({ value, amount, style }) => (\n  <div\n    style={{\n      ...style,\n      display: 'flex',\n      flexDirection: 'column',\n      marginRight: 4,\n      marginLeft: 4,\n    }}\n  >\n    <Typography>{`${value}RON`}</Typography>\n    <Typography>{`${amount}x`}</Typography>\n  </div>\n);\n\nconst Banknotes = ({ banknotes }) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        marginLeft: 4,\n        marginRight: 4,\n        marginTop: 4,\n        marginBottom: 4,\n      }}\n    >\n      <BanknoteCount value=\"1\" amount={banknotes['1']} />\n      <BanknoteCount value=\"5\" amount={banknotes['5']} />\n      <BanknoteCount value=\"10\" amount={banknotes['10']} />\n      <BanknoteCount value=\"50\" amount={banknotes['50']} />\n    </div>\n  );\n};\n\nexport default ({ event, style }) => {\n  const { type, ...data } = event;\n  const Icon = getEventIcon(type, data);\n  const isWarning = isEventWarning(type, data);\n  const [popoverAnchor, setPopoverAnchor] = React.useState(null);\n  const handleInfoClick = event => {\n    setPopoverAnchor(event.currentTarget);\n  };\n  const handleInfoClose = () => {\n    setPopoverAnchor(null);\n  };\n  return (\n    <div\n      style={{\n        ...style,\n        display: 'flex',\n        alignItems: 'center',\n        color: isWarning ? '#c60000' : undefined,\n      }}\n    >\n      <Icon />\n      <Typography variant=\"body2\" noWrap>\n        {formatEvent(type, data)}\n      </Typography>\n      {event.type === 'add-cash' ||\n      (event.type === 'add-card' && event.banknotes !== null) ? (\n        <>\n          <IconButton onClick={handleInfoClick}>\n            <InfoOutlined />\n          </IconButton>\n          <Popover\n            transitionDuration={0}\n            open={popoverAnchor !== null}\n            anchorEl={popoverAnchor}\n            onClose={handleInfoClose}\n            anchorOrigin={{\n              vertical: 'bottom',\n              horizontal: 'center',\n            }}\n            transformOrigin={{\n              vertical: 'top',\n              horizontal: 'center',\n            }}\n          >\n            <Banknotes banknotes={event.banknotes} />\n          </Popover>\n        </>\n      ) : null}\n    </div>\n  );\n};\n","// todo: use Ponyfill when https://github.com/formatjs/formatjs/issues/201 lands\ndelete Intl.RelativeTimeFormat;\nrequire('@formatjs/intl-relativetimeformat/polyfill');\nrequire('@formatjs/intl-relativetimeformat/locale-data/ro');\n\ndelete Intl.PluralRules;\nrequire('@formatjs/intl-pluralrules/polyfill');\nrequire('@formatjs/intl-pluralrules/locale-data/ro');\n\nconst cardinalRules = new Intl.PluralRules('ro', { type: 'cardinal' });\nconst relativeTimeFormat = new Intl.RelativeTimeFormat('ro', {\n  numeric: 'auto',\n});\nconst absoluteTimeFormat = new Intl.DateTimeFormat('ro', {\n  minute: 'numeric',\n  hour: 'numeric',\n});\n\nconst absoluteMonthCurrentYearFormat = new Intl.DateTimeFormat('ro', {\n  month: 'long',\n});\n\nconst absoluteMonthOtherYearFormat = new Intl.DateTimeFormat('ro', {\n  month: 'long',\n  year: 'numeric',\n});\n\nconst absoluteDayCurrentYearFormat = new Intl.DateTimeFormat('ro', {\n  day: 'numeric',\n  month: 'long',\n});\n\nconst absoluteDayOtherYearFormat = new Intl.DateTimeFormat('ro', {\n  day: 'numeric',\n  month: 'long',\n  year: 'numeric',\n});\n\nconst absoluteDayWeekFormat = new Intl.DateTimeFormat('ro', {\n  weekday: 'long',\n});\n\nconst cardinal = count => cardinalRules.select(count);\n\nexport const SELECTED_DEVICES = count => {\n  switch (cardinal(count)) {\n    case 'one':\n      return `${count} dispozitiv selectat`;\n    case 'few':\n      return `${count} dispozitive selectate`;\n    case 'other':\n      return `${count} de dispozitive selectate`;\n    default:\n      throw new Error();\n  }\n};\n\nexport const SELECTED_USERS = count => {\n  switch (cardinal(count)) {\n    case 'one':\n      return `${count} utilizator selectat`;\n    case 'few':\n      return `${count} utilizatori selectati`;\n    case 'other':\n      return `${count} de utilizatori selectati`;\n    default:\n      throw new Error();\n  }\n};\n\nexport const TIME_RELATIVE = (time, now = new Date().getTime()) => {\n  const deltaMilliseconds = time - now;\n  const deltaSeconds = deltaMilliseconds / 1000;\n  const deltaMinutes = deltaSeconds / 60;\n  if (Math.abs(deltaMinutes) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaSeconds), 'second');\n  }\n  const deltaHours = deltaMinutes / 60;\n  if (Math.abs(deltaHours) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaMinutes), 'minute');\n  }\n  const deltaDays = deltaHours / 24;\n  if (Math.abs(deltaDays) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaHours), 'hour');\n  }\n  const deltaMonths = deltaDays / (365 / 12);\n  if (Math.abs(deltaMonths) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaDays), 'day');\n  }\n  const deltaYears = deltaMonths / 12;\n  if (Math.abs(deltaYears) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaMonths), 'month');\n  }\n  return relativeTimeFormat.format(Math.trunc(deltaYears), 'year');\n};\n\n// todo: cap intervals at beginning of month/day for last month, last day, last year\nexport const DAY_RELATIVE = (time, now = new Date().getTime()) => {\n  const midnight = new Date(time);\n  midnight.setHours(0, 0, 0, 0);\n  const timestamp = midnight.getTime();\n\n  const deltaMilliseconds = timestamp - now;\n  const deltaSeconds = deltaMilliseconds / 1000;\n  const deltaMinutes = deltaSeconds / 60;\n  const deltaHours = deltaMinutes / 60;\n  const deltaDays = deltaHours / 24;\n  const deltaMonths = deltaDays / (365 / 12);\n\n  if (Math.abs(deltaMonths) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaDays), 'day');\n  }\n  const deltaYears = deltaMonths / 12;\n  if (Math.abs(deltaYears) < 1) {\n    return relativeTimeFormat.format(Math.trunc(deltaMonths), 'month');\n  }\n  return relativeTimeFormat.format(Math.trunc(deltaYears), 'year');\n};\n\nconst CURRENT_YEAR = new Date().getFullYear();\n\nexport const MONTH_ABSOLUTE = time => {\n  const date = new Date(time);\n  const absoluteDateFormat =\n    date.getFullYear() === CURRENT_YEAR\n      ? absoluteMonthCurrentYearFormat\n      : absoluteMonthOtherYearFormat;\n  return absoluteDateFormat.format(date);\n};\n\nexport const DAY_WEEK = time => {\n  const date = new Date(time);\n  return absoluteDayWeekFormat.format(date);\n};\n\nexport const DAY_ABSOLUTE = time => {\n  const date = new Date(time);\n  const absoluteDateFormat =\n    date.getFullYear() === CURRENT_YEAR\n      ? absoluteDayCurrentYearFormat\n      : absoluteDayOtherYearFormat;\n  return absoluteDateFormat.format(date);\n};\n\nexport const DAY_TIME_ABSOLUTE = time => {\n  const date = new Date(time);\n  return absoluteTimeFormat.format(date);\n};\n\nexport const TIME_ABSOLUTE = time => {\n  const date = new Date(time);\n  return `${DAY_ABSOLUTE(date)} ${absoluteTimeFormat.format(date)}`;\n};\n\nexport const NAME = 'Denumire';\nexport const EMAIL = 'Email';\n","\r\nimport React from 'react'\r\nimport { TextField, Tab, Tabs, Button, Tooltip } from '@material-ui/core';\r\nimport SignalBarIcon from './signal-bar-icon';\r\nimport { Link, useRouteMatch } from 'react-router-dom';\r\nimport { addCredit } from './user-api';\r\nimport DeviceEvents from './device/events';\r\nimport CashMonthly from './device/cash-monthly';\r\nimport CashTransaction from './device/cash-transaction';\r\nimport Notifications from './device/notifications';\r\nimport GsmSignal from './device/gsm-signal';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Event from './event';\r\nimport axios from 'axios'\r\n\r\nimport { Table, TableHead, TableBody, TableRow, TableCell, Typography } from '@material-ui/core';\r\nimport DayTime from './day-time';\r\n\r\nconst sortedDevices = [\r\n\r\n]\r\n\r\n\r\n\r\nvar ActiveTab, activePath\r\nexport default class Device extends React.Component {\r\n\r\n  constructor() {\r\n    super()\r\n    this.state = { sortedEvents: [] }\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    activePath = screens[0].path\r\n    ActiveTab = screens.find(({ path }) => path === activePath).component;\r\n\r\n\r\n    let deviceId = (window.location.href.split('/')[4])\r\n    axios.get(`http://localhost:5000/api/getdeviceevents/${deviceId}`).then((res) => {\r\n      alert(JSON.stringify(res.data.data))\r\n      this.setState({sortedEvents:res.data.data})\r\n    })\r\n    // activePath =  startupPath !== null ? startupPath : screens[0].path\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n  onClick = () => {\r\n    // const confirmed = window.confirm(\r\n    //   `Sigur doriti sa adaugati ${addCreditValue} credit pentru ${device.name}?`\r\n    // );\r\n    // if (confirmed) {\r\n    //   addCredit(deviceID, Number(addCreditValue));\r\n    // }\r\n  }\r\n\r\n  onSigur = () => {\r\n    // const confirmed = window.confirm(\r\n    //   `Sigur doriti sa resetati credit-ul pentru ${device.name}?`\r\n    // );\r\n    // if (confirmed) {\r\n    //   const now = firestore.Timestamp.now();\r\n    //   deviceRef\r\n    //     .collection('events')\r\n    //     .doc(generateID())\r\n    //     .set({\r\n    //       type: 'reset-credit-total',\r\n    //       timeSync: firestore.FieldValue.serverTimestamp(),\r\n    //       timeLocal: now,\r\n    //     });\r\n    //   deviceRef.update({\r\n    //     moneyReset: now,\r\n    //   });\r\n    // }\r\n  }\r\n\r\n  handleRoute = () => {\r\n    let param = (window.location.href.split('/')[5])\r\n    // if (para == 'events') this.setState({showMap:true})\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div style={Styles.Flex1}>\r\n        <div\r\n          style={Styles.Flex2}\r\n        >\r\n          <div\r\n            style={Styles.Flex3}\r\n          >\r\n\r\n            <Tooltip\r\n              title={\r\n                \"title\"\r\n                // typeof device.rssiDB === 'number'\r\n                //   ? `${device.rssiDB} db`\r\n                //   : 'Semnal GSM necunoscut'\r\n              }\r\n            >\r\n              <SignalBarIcon\r\n                rssiDB={\"device.rssiDB\"}\r\n                style={{ paddingTop: 24, marginRight: 12 }}\r\n              />\r\n            </Tooltip>\r\n\r\n            <TextField\r\n              label={'Denumire'}\r\n              value={'device.name'}\r\n              // onChange={({ target: { value } }) => {\r\n              //   deviceRef.update({ name: value });\r\n              // }}\r\n              margin=\"normal\"\r\n            />\r\n\r\n            <div style={{ width: 24 }} />\r\n\r\n            <TextField\r\n              label=\"Adaugare credit\"\r\n              value={'device.name'}\r\n              defaultValue={'addCreditValue.toString()'}\r\n              // onChange={({ target: { value } }) => {\r\n              //   setAddCreditValue(Number(value));\r\n              // }}\r\n              margin=\"normal\"\r\n            />\r\n\r\n            <Button onClick={() => { this.onClick() }}  >\r\n              Adaugare credit\r\n            </Button>\r\n\r\n          </div>\r\n\r\n          <div style={Styles.Flex4}  >\r\n            <Button onClick={() => { addCredit('deviceID', 0) }}  >    Resetare acceptor    </Button>\r\n\r\n            <Button onClick={() => { this.onSigur() }}>    Resetare credit  </Button>\r\n\r\n            <div\r\n              style={{\r\n                display: 'flex',\r\n                flexDirection: 'column',\r\n                alignItems: 'center',\r\n              }}\r\n            >\r\n              <Typography align=\"center\" variant=\"subtitle2\">\r\n                Ultimul reset la credit\r\n            </Typography>\r\n              {/* <DayTime\r\n                timestamp={'deviceMoneyResetTimestamp'}\r\n                style={{ alignItems: 'center' }}\r\n              /> */}\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n\r\n\r\n\r\n        <Tabs\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"on\"\r\n          value={\"activePath\"}\r\n          onChange={(_, newPath) => {\r\n            // setActivePath(newPath);\r\n          }}\r\n        >\r\n          {screens.map(({ path, title }) => (\r\n            <Tab\r\n              key={Math.random()}\r\n              onClick={() => { this.handleRoute() }}\r\n              value={path}\r\n              component={Link}\r\n              label={title}\r\n              to={`/device/cMeucuqYV2b/${path}`}\r\n            />\r\n          ))}\r\n        </Tabs>\r\n        {/* <ActiveTab\r\n          events={eventsWithResetTotal.map(\r\n            ({ timeSync, timeLocal, ...event }) => {\r\n              return { ...event, timeLocal, timeSync: timeSync || timeLocal };\r\n            }\r\n          )}\r\n          device={deviceWithID}\r\n        /> */}\r\n\r\n\r\n        <TableBody>\r\n\r\n          {this.state.sortedEvents.map((data) => {\r\n            // const isSelected = selectedSet.has('id');\r\n            // const isSelected = sel;\r\n\r\n            return (\r\n              <TableRow key={data.Device} hover selected={false} to={`/device/${data.Device}`}>\r\n                {/* <TableCell padding=\"checkbox\" onClick={() => toggleSelection(id)}> */}\r\n\r\n                {/* <TableCell padding=\"checkbox\" >\r\n        <Checkbox checked={true} />\r\n      </TableCell> */}\r\n\r\n                <TableCell>\r\n                  <Typography noWrap>{data.syncTime}</Typography>\r\n                </TableCell>\r\n\r\n                <TableCell padding=\"none\">\r\n                  <Event event={data.syncTime} />\r\n                </TableCell>\r\n\r\n\r\n                {/* <TableCell onClick={createDeviceOnClick('id')}>\r\n        {true ? <BusyTrueIcon /> : null}\r\n      </TableCell> */}\r\n                {/* \r\n                <TableCell padding=\"none\">\r\n                  <Event event={data.lastEvent} />\r\n                </TableCell> */}\r\n\r\n                <TableCell padding=\"none\">\r\n                  {/* <Time timestamp={lastEvent} /> */}\r\n                  {/* <Time timestamp={lastEvent.timeSync.toMillis()} /> */}\r\n                </TableCell>\r\n              </TableRow>\r\n            );\r\n          })}\r\n        </TableBody>\r\n\r\n      </div>\r\n\r\n    )\r\n  }\r\n}\r\n\r\n\r\nconst Styles = ({\r\n  Flex1: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    flex: 1\r\n  },\r\n  Flex2: {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    flexWrap: 'wrap',\r\n  },\r\n  Flex3: {\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    margin: '0 16px',\r\n  },\r\n  Flex4: {\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    margin: '0 16px',\r\n  }\r\n\r\n\r\n})\r\n\r\n\r\nconst screens = [\r\n  {\r\n    component: DeviceEvents,\r\n    title: 'Evenimente',\r\n    path: 'events',\r\n  },\r\n  {\r\n    component: CashMonthly,\r\n    title: 'Raport Bani Lunar',\r\n    path: 'cash-report',\r\n  },\r\n  {\r\n    component: CashTransaction,\r\n    title: 'Raport Bani Tranzactii',\r\n    path: 'cash-transaction',\r\n  },\r\n  {\r\n    component: Notifications,\r\n    title: 'Notificari',\r\n    path: 'notifications',\r\n  },\r\n  {\r\n    component: GsmSignal,\r\n    title: 'Semnal GSM',\r\n    path: 'gsm-signal',\r\n  },\r\n].map(({ component, title, path }) => ({\r\n  component,\r\n  title,\r\n  path,\r\n  fullPath: `localhost:3000/device/ekNhZncrnKm/${path}`,\r\n}));","import * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useTime } from './hooks';\nimport { TIME_RELATIVE, TIME_ABSOLUTE } from './translation';\n\nexport default ({ timestamp, style }) => {\n  const now = useTime();\n\n  return (\n    <div\n      style={{\n        ...style,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"body2\" noWrap>\n        {TIME_RELATIVE(timestamp, now)}\n      </Typography>\n      <Typography variant=\"subtitle2\" noWrap>\n        {TIME_ABSOLUTE(timestamp)}\n      </Typography>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n  Typography,\n} from '@material-ui/core';\n\nimport { Link } from 'react-router-dom';\nimport { Error as BusyFalseIcon } from '@material-ui/icons';\nimport axios from 'axios'\nimport TableSortLabel from '@material-ui/core/TableSortLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport stable from 'stable';\nimport { connect } from 'react-redux';\nimport Event from './event';\nimport Loading from './loading';\nimport { NAME } from './translation';\nimport Time from './day-time';\nimport { useIsUserAdmin } from './hooks';\n\nconst BusyTrueIcon = props => <BusyFalseIcon {...props} color=\"secondary\" />;\nvar selectedItems = []\n\nconst isDefaultAscending = key => {\n  switch (key) {\n    case 'name':\n    case 'isBusy':\n      return false;\n    default:\n      return true;\n  }\n};\n\nconst sortFunction = (sortBy, selected) => {\n  switch (sortBy) {\n    case 'isSelected': {\n      const isSelected = selected.reduce((acc, value) => {\n        return { ...acc, [value]: true };\n      }, {});\n      return (a, b) =>\n        (isSelected[a.id] === true ? 1 : 0) -\n        (isSelected[b.id] === true ? 1 : 0);\n    }\n    case 'name':\n      return (a, b) => a.name.localeCompare(b.name);\n    case 'isBusy':\n      return (a, b) => {\n        return a.isBusy !== b.isBusy ? 1 : -1;\n      };\n    case 'lastEvent':\n      return (a, b) =>\n        a.lastEvent.timeSync.toMillis() - b.lastEvent.timeSync.toMillis();\n    default:\n      throw new Error(`Unknown sort ${sortBy}`);\n  }\n};\n\n// const sort = (data, comparator, isAscending) => {\n//   const descSortedData = stable(data, comparator);\n//   return isAscending ? descSortedData.reverse() : descSortedData;\n// };\n\nconst Devices = ({\n  devices,\n  onDeviceClicked,\n  selected,\n  setSelected,\n  selectionLabel = '',\n  auth,\n}) => {\n\n\n  // const isAdmin = useIsUserAdmin(auth?.email || null);\n  const [orderBy, setOrderBy] = React.useState('name');\n  const [orderAscending, setOrderAscending] = React.useState(\n    isDefaultAscending(orderBy)\n  );\n  const [sortedDevices, setSortedDevices] = React.useState([]);\n  const [sel, setSel] = React.useState(false);\n\n  \n  let Url = window.location.href.includes('local') ? 'http://localhost:5000' : 'https://nameless-coast-52007.herokuapp.com'\n\n  axios.get(Url + '/api/devices').then((res) => {\n    setSortedDevices(res.data.data)\n    //alert(JSON.stringify(res.data.data))\n  })\n\n\n  const STATIC_COLUMNS = [\n    { key: 'name', label: NAME },\n    { key: 'isBusy', label: 'Stare dispozitiv' },\n    { key: 'lastEvent', label: 'Ultimul Eveniment', span: 2 },\n  ];\n\n  const selectedSet = new Set(selected);\n  // if (devices === null) {\n  //   return <Loading label=\"Se incarca lista de dispozitive\" />;\n  // }\n\n  //alert(\"here1\")\n\n  //   if (devices.length === 0) {\n  if (false) {\n    let text;\n    // if (isAdmin)\n    if (false) {\n      text = (\n        <Typography align=\"center\">\n          {\n            'Nu aveti dispozitive adaugate in cont, puteti sa va adaugati dispozitive din\\xA0'\n          }\n          <Link to=\"/users\">ecranul de administrator</Link>\n        </Typography>\n      );\n    } else {\n      text = (\n        <Typography>\n          Nu aveti dispozitive adaugate in cont, contactati un administrator\n        </Typography>\n      );\n    }\n\n\n\n\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flex: 1,\n          justifyContent: 'center',\n          alignItems: 'center',\n          padding: 16,\n        }}\n      >\n        {\"text\"}\n      </div>\n    );\n  }\n  //alert(\"here2\")\n\n  const toggleOrderBy = key => {\n    if (orderBy === key) {\n      setOrderAscending(old => !old);\n    } else {\n      setOrderBy(key);\n      setOrderAscending(isDefaultAscending(key));\n    }\n  };\n\n  const toggleSelection = id => {\n    setSelected(id, !selectedSet.has(id));\n  };\n\n  const Click = () => {\n    \n  }\n\n  const createDeviceOnClick = (id) =>\n    onDeviceClicked ? () => onDeviceClicked(id) : null;\n\n\n\n  // const sortedDevices = [\n  //   { name: \"BucuResti AFI\", id: \"123\", isBusy: true, lastEvent: 5 },\n  //   { name: \"Carrefour Militan\", id: \"124\", isBusy: true, lastEvent: 7 },\n  //   { name: \"Carousel DN\", id: \"125\", isBusy: true, lastEvent: 7 },\n  //   { name: \"RC2 Pallady\", id: \"126\", isBusy: true, lastEvent: 7 }\n  // ]\n\n  // const sortedDevices = sort(\n  //   devices,\n  //   sortFunction(orderBy, selected),\n  //   orderAscending\n  // );\n\n  // return (<h1>hello</h1>)\n\n  return (\n    <Table>\n      {/* <pre>{JSON.stringify([...selected], null, '\\t')}</pre> */}\n      <TableHead>\n        <TableRow>\n          {[\n            { key: 'isSelected', label: selectionLabel },\n            ...STATIC_COLUMNS,\n          ].map(({ key, label, span = 1 }, idx) => (\n            <TableCell\n              key={key}\n              colSpan={span}\n              align={idx === STATIC_COLUMNS.length - 1 ? 'center' : 'inherit'}\n            >\n              <TableSortLabel\n                active={orderBy === key}\n                direction={\n                  (orderBy === key\n                    ? orderAscending\n                    : isDefaultAscending(key))\n                    ? 'asc'\n                    : 'desc'\n                }\n                onClick={() => toggleOrderBy(key)}\n              >\n                {label}\n              </TableSortLabel>\n            </TableCell>\n          ))}\n        </TableRow>\n      </TableHead>\n\n      <TableBody>\n\n        {sortedDevices.map((data) => {\n          // const isSelected = selectedSet.has('id');\n          const isSelected = selectedItems.includes(data.Device) ? true : false;\n\n          return (\n            <TableRow key={data.Device} hover selected={isSelected} to={`/device/${data.Device}`}>\n              {/* <TableCell padding=\"checkbox\" onClick={() => toggleSelection(id)}> */}\n\n              <TableCell padding=\"checkbox\" onClick={() => {selectedItems.push(data.Device);setSel(true)} }>\n                <Checkbox checked={isSelected} />\n              </TableCell>\n\n              <TableCell onClick={createDeviceOnClick(data.Device)}>\n                <Typography noWrap>{data.name}</Typography>\n              </TableCell>\n\n              {/* <TableCell onClick={createDeviceOnClick('id')}>\n                {true ? <BusyTrueIcon /> : null}\n              </TableCell> */}\n              \n              <TableCell onClick={createDeviceOnClick(data.Device)} padding=\"none\">\n                <Event event={data.lastEvent} />\n              </TableCell>\n\n              <TableCell onClick={createDeviceOnClick('id')} padding=\"none\">\n                {/* <Time timestamp={lastEvent} /> */}\n                {/* <Time timestamp={lastEvent.timeSync.toMillis()} /> */}\n              </TableCell>\n            </TableRow>\n          );\n        })}\n      </TableBody>\n    </Table>\n  );\n};\n\nexport default connect(({ firebase: { auth } }) => ({\n  auth,\n}))(Devices);\n\n\n","import * as React from 'react';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\nimport {\n  Toolbar,\n  Typography,\n  Tooltip,\n  IconButton,\n  makeStyles,\n} from '@material-ui/core';\nimport { lighten } from '@material-ui/core/styles';\nimport { EventBusy as EventBusyIcon } from '@material-ui/icons';\nimport { useLeavePrompt, useLoadUserDevices } from './hooks';\nimport Devices from './devices';\nimport { SELECTED_DEVICES } from './translation';\n\nconst useStyles = makeStyles(theme => ({\n  highlight: {\n    color: theme.palette.secondary.main,\n    backgroundColor: lighten(theme.palette.secondary.light, 0.85),\n  },\n}));\n\nexport default compose(\n  withRouter,\n\n  // connect(state => ({\n  //   devices: state.firestore.ordered.devices || null,\n  //   authEmail: state.firebase.auth.email || null,\n  // })\n  \n  // )\n\n\n)(({ history, authEmail }) => {\n\n  const [selected, setSelected] = React.useState(new Set());\n  const hasSelected = selected.size > 0;\n  const classes = useStyles();\n  // const devices = useLoadUserDevices(authEmail);\n\n  useLeavePrompt(hasSelected);\n  const onDeviceClicked = id => history.push(`/device/${id}`);\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column', flex: 1 }}>\n\n      <Toolbar className={hasSelected ? classes.highlight : undefined}>\n        <Typography variant=\"h6\" id=\"tableTitle\">\n          {hasSelected ? SELECTED_DEVICES(selected.size) : 'Dispozitive'}\n        </Typography>\n        {hasSelected ? (\n          <>\n            <Tooltip title=\"Sterge evenimente\">\n              <IconButton>\n                <EventBusyIcon />\n              </IconButton>\n            </Tooltip>\n          </>\n        ) : null}\n      </Toolbar>\n\n      <Devices\n        onDeviceClicked={onDeviceClicked}\n        // devices={devices}\n        selected={[...selected]}\n        setSelected={(id, state) => {\n          setSelected(old => {\n            const set = new Set(old);\n            if (state) {\n              set.add(id);\n            } else {\n              set.delete(id);\n            }\n            return set;\n          });\n        }}\n      />\n      \n    </div>\n  );\n});\n","import axios from 'axios';\nimport { API_URL } from './config';\nimport { refreshAddCreditEvents } from './hooks';\n\nexport const addCredit = async (deviceID, amount) => {\n  await axios.post(`${API_URL}/add-credit`, {\n    deviceID,\n    amount,\n  });\n  refreshAddCreditEvents();\n};\n","import * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { DAY_TIME_ABSOLUTE } from './translation';\n\nexport default ({ timestamp, style }) => {\n  return (\n    <div\n      style={{\n        ...style,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"subtitle2\" noWrap>\n        {DAY_TIME_ABSOLUTE(timestamp)}\n      </Typography>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useTime } from './hooks';\nimport { DAY_RELATIVE, DAY_ABSOLUTE } from './translation';\n\nexport default ({ timestamp, style }) => {\n  const now = useTime();\n\n  return (\n    <div\n      style={{\n        ...style,\n        paddingLeft: 16,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"body2\" noWrap>\n        {DAY_RELATIVE(timestamp, now)}\n      </Typography>\n      <Typography variant=\"subtitle2\" noWrap>\n        {DAY_ABSOLUTE(timestamp)}\n      </Typography>\n    </div>\n  );\n};\n","import AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeList } from 'react-window';\nimport * as React from 'react';\nimport { useResetReactWindowCache } from '../hooks';\nimport Time from '../time';\nimport Day from '../day';\nimport Event from '../event';\n\nconst DAY_HEIGHT = 45;\nconst DAY_EVENT_HEIGHT = 45;\n\nconst DayEvent = ({ event }) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        height: DAY_EVENT_HEIGHT,\n        alignItems: 'center',\n      }}\n    >\n      <Time\n        hideDate\n        style={{ marginLeft: 8, width: 40 }}\n        timestamp={event.timeSync.toMillis()}\n      />\n      <Event style={{ marginLeft: 16, width: 180 }} event={{ ...event }} />\n    </div>\n  );\n};\nconst Row = ({ data: days, index, style }) => {\n  const day = days[index];\n  return (\n    <div style={style}>\n      <Day\n        style={{\n          position: 'sticky',\n          top: 0,\n          background: '#889aff',\n          height: DAY_HEIGHT,\n          zIndex: 1,\n        }}\n        timestamp={day.timestamp}\n      />\n      {day.events.map(event => (\n        <DayEvent event={event} key={event.id} />\n      ))}\n    </div>\n  );\n};\n\nconst getDayLayoutHeight = day =>\n  DAY_HEIGHT + day.events.length * DAY_EVENT_HEIGHT;\n\nconst addBanknotes = events => {\n  let lastBanknotes = null;\n  return events\n    .reverse()\n    .map(event => {\n      switch (event.type) {\n        case 'reset-credit-total':\n          lastBanknotes = {\n            '1': 0,\n            '5': 0,\n            '10': 0,\n            '50': 0,\n          };\n          return event;\n        case 'add-cash':\n          if (lastBanknotes === null) {\n            lastBanknotes = {\n              '1': 0,\n              '5': 0,\n              '10': 0,\n              '50': 0,\n            };\n          }\n          lastBanknotes = {\n            ...lastBanknotes,\n            [event.amount]: lastBanknotes[event.amount] + 1,\n          };\n          return {\n            ...event,\n            banknotes: lastBanknotes,\n          };\n        default:\n          return event;\n      }\n    })\n    .reverse();\n};\n\nexport default ({ events }) => {\n  const days = addBanknotes(events).reduceRight((days, event) => {\n    const midnight = new Date(event.timeSync.toMillis());\n    midnight.setHours(0, 0, 0, 0);\n    const timestamp = midnight.getTime();\n    const [lastDay = null, ...otherDays] = days;\n\n    if (lastDay === null) {\n      return [{ timestamp, events: [event] }, ...otherDays];\n    }\n    if (lastDay.timestamp !== timestamp) {\n      return [{ timestamp, events: [event] }, lastDay, ...otherDays];\n    }\n    return [{ timestamp, events: [event, ...lastDay.events] }, ...otherDays];\n  }, []);\n  const estimatedHeight =\n    days.reduce((sum, day) => sum + getDayLayoutHeight(day), 0) / days.length;\n\n  const reactWindowListRef = useResetReactWindowCache(events);\n\n  return (\n    <div style={{ flex: 1 }}>\n      <AutoSizer>\n        {({ height, width }) => (\n          <VariableSizeList\n            ref={reactWindowListRef}\n            width={width}\n            height={height}\n            itemCount={days.length}\n            estimatedItemSize={estimatedHeight}\n            itemSize={index => getDayLayoutHeight(days[index])}\n            itemKey={index => days[index].timestamp}\n            itemData={days}\n          >\n            {Row}\n          </VariableSizeList>\n        )}\n      </AutoSizer>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useTime } from './hooks';\nimport { DAY_ABSOLUTE, DAY_WEEK } from './translation';\n\nexport default ({ timestamp, style }) => {\n  const now = useTime();\n\n  return (\n    <div\n      style={{\n        ...style,\n        paddingLeft: 16,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"body2\" noWrap>\n        {DAY_WEEK(timestamp, now)}\n      </Typography>\n      <Typography variant=\"subtitle2\" noWrap>\n        {DAY_ABSOLUTE(timestamp)}\n      </Typography>\n    </div>\n  );\n};\n","import AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeList } from 'react-window';\nimport * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useResetReactWindowCache } from '../hooks';\nimport { MONTH_ABSOLUTE } from '../translation';\nimport DayWeek from '../day-week';\n\nconst Month = ({ timestamp, amountCash, amountCard, style }) => {\n  return (\n    <div\n      style={{\n        ...style,\n        paddingLeft: 16,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"subtitle2\" noWrap>\n        {`${MONTH_ABSOLUTE(\n          timestamp\n        )} - ${amountCash} RON (cash) ${amountCard} RON (card)`}\n      </Typography>\n    </div>\n  );\n};\n\nconst DAY_HEIGHT = 45;\nconst DAY_EVENT_HEIGHT = 45;\n\nconst DayEvent = ({ timestamp, amountCash, amountCard }) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        height: DAY_EVENT_HEIGHT,\n        alignItems: 'center',\n      }}\n    >\n      <DayWeek style={{ width: 60 }} timestamp={timestamp} />\n      <Typography variant=\"body2\" noWrap align=\"right\" style={{ width: 50 }}>\n        {amountCash}\n      </Typography>\n      <Typography variant=\"body2\" noWrap>\n        &nbsp;RON (cash)\n      </Typography>\n      <Typography variant=\"body2\" noWrap align=\"right\" style={{ width: 50 }}>\n        {amountCard}\n      </Typography>\n      <Typography variant=\"body2\" noWrap>\n        &nbsp;RON (card)\n      </Typography>\n    </div>\n  );\n};\nconst Row = ({ data: months, index, style }) => {\n  const month = months[index];\n  return (\n    <div style={style}>\n      <Month\n        style={{\n          position: 'sticky',\n          top: 0,\n          background: '#889aff',\n          height: DAY_HEIGHT,\n        }}\n        timestamp={month.timestamp}\n        amountCash={month.amountCash}\n        amountCard={month.amountCard}\n      />\n      {month.events.map(({ timestamp, amountCash, amountCard }) => (\n        <DayEvent\n          timestamp={timestamp}\n          amountCash={amountCash}\n          amountCard={amountCard}\n          key={timestamp}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst getDayLayoutHeight = day =>\n  DAY_HEIGHT + day.events.length * DAY_EVENT_HEIGHT;\n\nconst groupByMonths = events =>\n  events.reduceRight((months, event) => {\n    const startOfMonth = new Date(event.timeSync.toMillis());\n    startOfMonth.setDate(1);\n    startOfMonth.setHours(0, 0, 0, 0);\n    const timestamp = startOfMonth.getTime();\n    const [lastDay = null, ...otherDays] = months;\n\n    if (event.type === 'add-cash') {\n      if (lastDay === null) {\n        return [\n          {\n            timestamp,\n            amountCash: event.amount,\n            amountCard: 0,\n            events: [event],\n          },\n          ...otherDays,\n        ];\n      }\n      if (lastDay.timestamp !== timestamp) {\n        return [\n          {\n            timestamp,\n            amountCash: event.amount,\n            amountCard: 0,\n            events: [event],\n          },\n          lastDay,\n          ...otherDays,\n        ];\n      }\n      return [\n        {\n          timestamp,\n          amountCash: lastDay.amountCash + event.amount,\n          amountCard: lastDay.amountCard,\n          events: [event, ...lastDay.events],\n        },\n        ...otherDays,\n      ];\n    }\n    if (event.type === 'add-card') {\n      if (lastDay === null) {\n        return [\n          {\n            timestamp,\n            amountCash: 0,\n            amountCard: event.amount,\n            events: [event],\n          },\n          ...otherDays,\n        ];\n      }\n      if (lastDay.timestamp !== timestamp) {\n        return [\n          {\n            timestamp,\n            amountCash: 0,\n            amountCard: event.amount,\n            events: [event],\n          },\n          lastDay,\n          ...otherDays,\n        ];\n      }\n      return [\n        {\n          timestamp,\n          amountCash: lastDay.amountCash,\n          amountCard: lastDay.amountCard + event.amount,\n          events: [event, ...lastDay.events],\n        },\n        ...otherDays,\n      ];\n    }\n    throw new Error(`Unknown event type ${event.type}`);\n  }, []);\n\nconst sumByDay = events =>\n  events.reduceRight((months, event) => {\n    const startOfDay = new Date(event.timeSync.toMillis());\n    startOfDay.setHours(0, 0, 0, 0);\n    const timestamp = startOfDay.getTime();\n    const [lastDay = null, ...otherDays] = months;\n\n    if (event.type === 'add-cash') {\n      if (lastDay === null) {\n        return [\n          { timestamp, amountCash: event.amount, amountCard: 0 },\n          ...otherDays,\n        ];\n      }\n      if (lastDay.timestamp !== timestamp) {\n        return [\n          { timestamp, amountCash: event.amount, amountCard: 0 },\n          lastDay,\n          ...otherDays,\n        ];\n      }\n      return [\n        {\n          timestamp,\n          amountCash: event.amount + lastDay.amountCash,\n          amountCard: lastDay.amountCard,\n        },\n        ...otherDays,\n      ];\n    }\n    if (event.type === 'add-card') {\n      if (lastDay === null) {\n        return [\n          { timestamp, amountCash: 0, amountCard: event.amount },\n          ...otherDays,\n        ];\n      }\n      if (lastDay.timestamp !== timestamp) {\n        return [\n          { timestamp, amountCash: 0, amountCard: event.amount },\n          lastDay,\n          ...otherDays,\n        ];\n      }\n      return [\n        {\n          timestamp,\n          amountCash: lastDay.amountCash,\n          amountCard: event.amount + lastDay.amount,\n        },\n        ...otherDays,\n      ];\n    }\n    throw new Error(`Unknown event type ${event.type}`);\n  }, []);\n\nexport default ({ events }) => {\n  const cashEvents = events.filter(\n    ({ type }) => type === 'add-cash' || type === 'add-card'\n  );\n\n  const months = groupByMonths(cashEvents).map(\n    ({ timestamp, amountCash, amountCard, events }) => ({\n      timestamp,\n      amountCash,\n      amountCard,\n      events: sumByDay(events),\n    })\n  );\n  const estimatedHeight =\n    months.reduce((sum, day) => sum + getDayLayoutHeight(day), 0) /\n    months.length;\n\n  const reactWindowListRef = useResetReactWindowCache(cashEvents);\n\n  return (\n    <div style={{ flex: 1 }}>\n      <AutoSizer>\n        {({ height, width }) => (\n          <VariableSizeList\n            ref={reactWindowListRef}\n            width={width}\n            height={height}\n            itemCount={months.length}\n            estimatedItemSize={estimatedHeight}\n            itemSize={index => getDayLayoutHeight(months[index])}\n            itemKey={index => months[index].timestamp}\n            itemData={months}\n          >\n            {Row}\n          </VariableSizeList>\n        )}\n      </AutoSizer>\n    </div>\n  );\n};\n","import AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeList } from 'react-window';\nimport * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useResetReactWindowCache } from '../hooks';\nimport { MONTH_ABSOLUTE } from '../translation';\nimport DayTime from '../day-time';\n// import { TRANSACTION_DEBOUNCE_INTERVAL } from '../config';\n\nconst Month = ({ timestamp, amount, style }) => {\n  return (\n    <div\n      style={{\n        ...style,\n        paddingLeft: 16,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n      }}\n    >\n      <Typography variant=\"subtitle2\" noWrap>\n        {`${MONTH_ABSOLUTE(timestamp)} - ${amount} RON`}\n      </Typography>\n    </div>\n  );\n};\n\nconst DAY_HEIGHT = 45;\nconst DAY_EVENT_HEIGHT = 45;\n\nconst DayEvent = ({ timestamp, amount }) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        height: DAY_EVENT_HEIGHT,\n        alignItems: 'center',\n      }}\n    >\n      <DayTime style={{ marginLeft: 16, width: 170 }} timestamp={timestamp} />\n      <Typography variant=\"body2\" noWrap align=\"right\" style={{ width: 50 }}>\n        {amount}\n      </Typography>\n      <Typography variant=\"body2\" noWrap>\n        &nbsp;RON\n      </Typography>\n    </div>\n  );\n};\nconst Row = ({ data: months, index, style }) => {\n  const month = months[index];\n  return (\n    <div style={style}>\n      <Month\n        style={{\n          position: 'sticky',\n          top: 0,\n          background: '#889aff',\n          height: DAY_HEIGHT,\n        }}\n        timestamp={month.timestamp}\n        amount={month.amount}\n      />\n      {month.events.map(({ timestamp, amount }) => (\n        <DayEvent timestamp={timestamp} amount={amount} key={timestamp} />\n      ))}\n    </div>\n  );\n};\n\nconst getDayLayoutHeight = day =>\n  DAY_HEIGHT + day.events.length * DAY_EVENT_HEIGHT;\n\nconst groupByMonths = events =>\n  events.reduceRight((months, event) => {\n    const startOfMonth = new Date(event.timeSync.toMillis());\n    startOfMonth.setDate(1);\n    startOfMonth.setHours(0, 0, 0, 0);\n    const timestamp = startOfMonth.getTime();\n    const [lastDay = null, ...otherDays] = months;\n\n    if (lastDay === null) {\n      return [\n        { timestamp, amount: event.amount, events: [event] },\n        ...otherDays,\n      ];\n    }\n    if (lastDay.timestamp !== timestamp) {\n      return [\n        { timestamp, amount: event.amount, events: [event] },\n        lastDay,\n        ...otherDays,\n      ];\n    }\n    return [\n      {\n        timestamp,\n        amount: lastDay.amount + event.amount,\n        events: [event, ...lastDay.events],\n      },\n      ...otherDays,\n    ];\n  }, []);\n\nconst sumByTransaction = events =>\n  events.reduceRight((months, event) => {\n    const timestamp = event.timeSync.toMillis();\n    const [lastTransaction = null, ...otherDays] = months;\n\n    if (lastTransaction === null) {\n      return [{ timestamp, amount: event.amount }, ...otherDays];\n    }\n    // if (timestamp - lastTransaction.timestamp > TRANSACTION_DEBOUNCE_INTERVAL) {\n    //   return [\n    //     { timestamp, amount: event.amount },\n    //     lastTransaction,\n    //     ...otherDays,\n    //   ];\n    // }\n    return [\n      {\n        timestamp: lastTransaction.timestamp,\n        amount: event.amount + lastTransaction.amount,\n      },\n      ...otherDays,\n    ];\n  }, []);\n\nexport default ({ events }) => {\n  const cashEvents = events.filter(\n    ({ type }) => type === 'add-cash' || type === 'add-card'\n  );\n\n  const months = groupByMonths(cashEvents).map(\n    ({ timestamp, amount, events }) => ({\n      timestamp,\n      amount,\n      events: sumByTransaction(events),\n    })\n  );\n  const estimatedHeight =\n    months.reduce((sum, day) => sum + getDayLayoutHeight(day), 0) /\n    months.length;\n\n  const reactWindowListRef = useResetReactWindowCache(cashEvents);\n\n  return (\n    <div style={{ flex: 1 }}>\n      <AutoSizer>\n        {({ height, width }) => (\n          <VariableSizeList\n            ref={reactWindowListRef}\n            width={width}\n            height={height}\n            itemCount={months.length}\n            estimatedItemSize={estimatedHeight}\n            itemSize={index => getDayLayoutHeight(months[index])}\n            itemKey={index => months[index].timestamp}\n            itemData={months}\n          >\n            {Row}\n          </VariableSizeList>\n        )}\n      </AutoSizer>\n    </div>\n  );\n};\n","import { BROWSER_NAME } from './config';\n\nexport const webPushPermissionInfo = permission => {\n  switch (permission) {\n    case 'unsupported':\n      return `Acest browser (${BROWSER_NAME}) nu permite notificari`;\n    case 'denied':\n      return `Notificarile sunt dezactivate din ${BROWSER_NAME}`;\n    case 'default':\n      return `Apasati pentru activare notificari`;\n    case 'granted':\n      return 'Notificari active';\n    default:\n      throw new Error(`Unknown web push permission ${permission}`);\n  }\n};\n\nexport default null;\n","import AutoSizer from 'react-virtualized-auto-sizer';\nimport { VariableSizeList } from 'react-window';\nimport * as React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useResetReactWindowCache, useSignalData } from '../hooks';\nimport Time from '../time';\nimport Day from '../day';\nimport Event from '../event';\n\nconst DAY_HEIGHT = 45;\nconst DAY_EVENT_HEIGHT = 45;\n\nconst DayEvent = ({ event }) => {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        height: DAY_EVENT_HEIGHT,\n        alignItems: 'center',\n      }}\n    >\n      <Time\n        hideDate\n        style={{ marginLeft: 16, width: 50 }}\n        timestamp={event.timeSync.toMillis()}\n      />\n      <Event style={{ marginLeft: 16, width: 180 }} event={{ ...event }} />\n    </div>\n  );\n};\nconst Row = ({ data: days, index, style }) => {\n  const day = days[index];\n  return (\n    <div style={style}>\n      <Day\n        style={{\n          position: 'sticky',\n          top: 0,\n          background: '#889aff',\n          height: DAY_HEIGHT,\n        }}\n        timestamp={day.timestamp}\n      />\n      {day.events.map(event => (\n        <DayEvent event={event} key={event.id} />\n      ))}\n    </div>\n  );\n};\n\nconst getDayLayoutHeight = day =>\n  DAY_HEIGHT + day.events.length * DAY_EVENT_HEIGHT;\n\nexport default ({ device }) => {\n  const events = useSignalData(device.id);\n  const days = events.reduceRight((days, event) => {\n    const midnight = new Date(event.timeSync.toMillis());\n    midnight.setHours(0, 0, 0, 0);\n    const timestamp = midnight.getTime();\n    const [lastDay = null, ...otherDays] = days;\n\n    if (lastDay === null) {\n      return [{ timestamp, events: [event] }, ...otherDays];\n    }\n    if (lastDay.timestamp !== timestamp) {\n      return [{ timestamp, events: [event] }, lastDay, ...otherDays];\n    }\n    return [{ timestamp, events: [event, ...lastDay.events] }, ...otherDays];\n  }, []);\n  const estimatedHeight =\n    days.reduce((sum, day) => sum + getDayLayoutHeight(day), 0) / days.length;\n\n  const reactWindowListRef = useResetReactWindowCache(events);\n\n  return (\n    <div style={{ flex: 1 }}>\n      <AutoSizer>\n        {({ height, width }) => (\n          <VariableSizeList\n            ref={reactWindowListRef}\n            width={width}\n            height={height}\n            itemCount={days.length}\n            estimatedItemSize={estimatedHeight}\n            itemSize={index => getDayLayoutHeight(days[index])}\n            itemKey={index => days[index].timestamp}\n            itemData={days}\n          >\n            {Row}\n          </VariableSizeList>\n        )}\n      </AutoSizer>\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { Switch, FormControlLabel, Button } from '@material-ui/core';\nimport { useFirestore } from 'react-redux-firebase';\nimport { firebase } from '@firebase/app';\nimport { Warning as WarnIcon } from '@material-ui/icons';\nimport { useAuthEmail, useUserData, useNotificationPermission } from '../hooks';\nimport { webPushPermissionInfo } from '../i18n';\n\nexport default ({ device }) => {\n  const userEmail = useAuthEmail();\n  const userData = useUserData(userEmail);\n\n  const isWatched =\n    userData === null\n      ? null\n      : (userData.watchedDevices || []).includes(device.id);\n\n  const { notificationPermission, triggerPrompt } = useNotificationPermission();\n\n  const firestoreDB = useFirestore();\n\n  const setIsWatched = newIsWatched => {\n    if (newIsWatched && notificationPermission === 'default') {\n      triggerPrompt();\n    }\n    const { FieldValue } = firebase.firestore;\n    firestoreDB\n      .collection('emails')\n      .doc(userEmail)\n      .update({\n        watchedDevices: (newIsWatched\n          ? FieldValue.arrayUnion\n          : FieldValue.arrayRemove)(device.id),\n      });\n  };\n\n  const sw = (\n    <Switch\n      checked={isWatched === true}\n      onChange={(_, newValue) => {\n        setIsWatched(newValue);\n      }}\n    />\n  );\n\n  const cantWatch = isWatched === true && notificationPermission !== 'granted';\n\n  return (\n    <div>\n      <FormControlLabel\n        style={{ margin: 18 }}\n        disabled={isWatched === null || cantWatch}\n        control={sw}\n        label={`Notificari ${isWatched ? 'active' : 'inactive'}`}\n      />\n      {cantWatch ? (\n        <Button\n          color=\"primary\"\n          variant=\"contained\"\n          onClick={triggerPrompt}\n          disabled={notificationPermission === 'denied'}\n          startIcon={<WarnIcon />}\n        >\n          {webPushPermissionInfo(notificationPermission)}\n        </Button>\n      ) : null}\n    </div>\n  );\n};\n","import * as React from 'react';\nimport { Typography, Button } from '@material-ui/core';\nimport { withFirebase } from 'react-redux-firebase';\n\nconst MissingPermission = ({ firebase }) => (\n  <div\n    style={{\n      display: 'flex',\n      flex: 1,\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center',\n    }}\n  >\n    <Typography style={{ marginBottom: 12 }}>\n      Acest cont nu are permisione pentru a vizualiza datele\n    </Typography>\n    <Button\n      variant=\"contained\"\n      color=\"primary\"\n      onClick={() => {\n        firebase.logout();\n      }}\n    >\n      Log out\n    </Button>\n  </div>\n);\n\nexport default withFirebase(MissingPermission);\n","import * as React from 'react';\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { compose } from 'redux';\nimport { connect } from 'react-redux';\nimport { isEmail } from 'validator';\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableCell,\n  Typography,\n  Toolbar,\n  Tooltip,\n  IconButton,\n  Fab,\n  Dialog,\n  DialogTitle,\n  DialogContentText,\n  TextField,\n  DialogContent,\n  DialogActions,\n  Button,\n  Checkbox,\n  makeStyles,\n} from '@material-ui/core';\nimport { EventBusy as EventBusyIcon, Add } from '@material-ui/icons';\nimport { lighten } from '@material-ui/core/styles';\n\nimport { withRouter } from 'react-router-dom';\n\nimport TableSortLabel from '@material-ui/core/TableSortLabel';\nimport stable from 'stable';\nimport { EMAIL, SELECTED_USERS } from '../translation';\nimport Loading from '../loading';\n\nconst isDefaultAscending = (key) => {\n  switch (key) {\n    case 'email':\n    case 'isAdmin':\n      return false;\n    default:\n      return true;\n  }\n};\n\nconst sortFunction = sortBy => {\n  switch (sortBy) {\n    case 'email':\n      return (a, b) => a.email.localeCompare(b.name);\n    case 'isAdmin':\n      return (a, b) => {\n        return a.isAdmin !== b.isAdmin ? 1 : -1;\n      };\n    default:\n      throw new Error(`Unknown sort ${sortBy}`);\n  }\n};\n\n\nconst sort = (data, comparator, isAscending) => {\n  const descSortedData = stable(data, comparator);\n  return isAscending ? descSortedData.reverse() : descSortedData;\n};\nconst columns = [\n  { key: 'email', label: EMAIL },\n  { key: 'isAdmin', label: 'Administrator' },\n];\n\nconst useStyles = makeStyles(theme => ({\n  highlight: {\n    color: theme.palette.secondary.main,\n    backgroundColor: lighten(theme.palette.secondary.light, 0.85),\n  },\n}));\nconst Users = ({ emails, history, firestore }) => {\n  const addUser = newEmail => {\n    firestore\n      .collection('emails')\n      .doc(newEmail)\n      .set({ isAdmin: false });\n  };\n  const deleteUsers = deleteEmails => {\n    const batch = firestore.batch();\n    deleteEmails.forEach(email => {\n      batch.delete(firestore.collection('emails').doc(email));\n    });\n    batch.commit();\n  };\n  const [showAddUser, setShowAddUser] = React.useState(false);\n  const [isInvalidEmail, setIsInvalidEmail] = React.useState(false);\n  const [newEmail, setNewEmail] = React.useState('');\n\n  const closeModal = () => {\n    setShowAddUser(false);\n    setIsInvalidEmail(false);\n  };\n\n  const classes = useStyles();\n  const [selected, setSelected] = React.useState(new Set());\n  const hasSelected = selected.size > 0;\n  const [orderBy, setOrderBy] = React.useState('email');\n  const [orderAscending, setOrderAscending] = React.useState(\n    isDefaultAscending(orderBy)\n  );\n\n  if (emails === null) {\n    return <Loading label=\"Se incarca lista de dispozitive\" />;\n  }\n\n  const toggleOrderBy = key => {\n    if (orderBy === key) {\n      setOrderAscending(old => !old);\n    } else {\n      setOrderBy(key);\n      setOrderAscending(isDefaultAscending(key));\n    }\n  };\n\n  const toggleSelection = id => {\n    setSelected(old => {\n      const set = new Set(old);\n      if (set.has(id)) {\n        set.delete(id);\n      } else {\n        set.add(id);\n      }\n      return set;\n    });\n  };\n\n  const createViewUserNav = email => () => history.push(`/users/${email}`);\n\n  // const sortedEmails = sort(emails, sortFunction(orderBy), orderAscending);\n\n  const sortedEmails = [{ email: 'princehamzi.mine@gmail.com' }, { email: 'Female.Email@gmail.com', isAdmin: true }]\n\n  const trySubmitEmail = () => {\n    if (isEmail(newEmail)) {\n      addUser(newEmail);\n      setShowAddUser(false);\n    } else {\n      setIsInvalidEmail(true);\n    }\n  };\n  return (\n    <div>\n      <Toolbar className={hasSelected ? classes.highlight : undefined}>\n        <Typography variant=\"h6\" id=\"tableTitle\">\n          {hasSelected ? SELECTED_USERS(selected.size) : 'Utilizatori'}\n        </Typography>\n        {hasSelected ? (\n          <>\n            <Tooltip title=\"Sterge utilizatori\">\n              <IconButton\n                onClick={() => {\n                  deleteUsers([...selected]);\n                  setSelected(old => {\n                    const set = new Set(old);\n                    selected.forEach(email => {\n                      set.delete(email);\n                    });\n                    return set;\n                  });\n                }}\n              >\n                <EventBusyIcon />\n              </IconButton>\n            </Tooltip>\n          </>\n        ) : null}\n      </Toolbar>\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell />\n            {columns.map(({ key, label, span = 1 }, idx) => (\n              <TableCell\n                key={key}\n                colSpan={span}\n                align={idx === columns.length - 1 ? 'center' : 'inherit'}\n              >\n                <TableSortLabel\n                  active={orderBy === key}\n                  direction={\n                    (orderBy === key\n                      ? orderAscending\n                      : isDefaultAscending(key))\n                      ? 'asc'\n                      : 'desc'\n                  }\n                  onClick={() => toggleOrderBy(key)}\n                >\n                  {label}\n                </TableSortLabel>\n              </TableCell>\n            ))}\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {sortedEmails.map(({ email, isAdmin }) => {\n            const isSelected = selected.has(email);\n            return (\n              <TableRow\n                key={email}\n                hover\n                selected={isSelected}\n                to={`/device/${email}`}\n              >\n                <TableCell\n                  padding=\"checkbox\"\n                  onClick={() => toggleSelection(email)}\n                >\n                  <Checkbox checked={isSelected} />\n                </TableCell>\n                <TableCell onClick={createViewUserNav(email)}>\n                  <Typography noWrap>{email}</Typography>\n                </TableCell>\n                <TableCell onClick={createViewUserNav(email)}>\n                  <Typography noWrap>{isAdmin ? 'is admin' : ''}</Typography>\n                </TableCell>\n              </TableRow>\n            );\n          })}\n        </TableBody>\n      </Table>\n      <Fab\n        color=\"primary\"\n        style={{ position: 'absolute', right: 16, bottom: 16 }}\n        onClick={() => {\n          setShowAddUser(true);\n        }}\n      >\n        <Add />\n      </Fab>\n\n      <Dialog open={showAddUser} onClose={closeModal}>\n        <DialogTitle>Adaugare user</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            Va rog sa adaugati o adresa de email asociata cu un cont Google\n          </DialogContentText>\n          <TextField\n            error={isInvalidEmail}\n            helperText={isInvalidEmail ? 'email invalid' : undefined}\n            onChange={({ target }) => {\n              setNewEmail(target.value);\n              setIsInvalidEmail(false);\n            }}\n            onKeyDown={event => {\n              if (event.keyCode === 13) {\n                trySubmitEmail();\n                event.preventDefault();\n              }\n            }}\n            autoFocus\n            margin=\"dense\"\n            id=\"name\"\n            label=\"Adresa Email\"\n            type=\"email\"\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeModal}>Anulare</Button>\n          <Button onClick={trySubmitEmail} color=\"primary\">\n            Adaugare\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n};\nexport default compose(\n  withRouter,\n  connect(state => ({\n    emails:\n      state.firestore.ordered.emails?.map(({ id, isAdmin }) => ({\n        email: id,\n        isAdmin,\n      })) || null,\n  })),\n  firestoreConnect([\n    {\n      collection: 'emails',\n    },\n  ])\n)(Users);\n","import * as React from 'react';\nimport { useFirestore } from 'react-redux-firebase';\nimport { FormControlLabel, Checkbox, Typography } from '@material-ui/core';\nimport { firebase } from '@firebase/app';\nimport Devices from '../devices';\nimport Loading from '../loading';\nimport { useIsUserAdmin, useLoadAllDevices } from '../hooks';\n\nexport default ({ email }) => {\n  const isAdmin = useIsUserAdmin(email);\n\n  const devices = useLoadAllDevices();\n  const firestoreDB = useFirestore();\n  if (devices === null) {\n    return <Loading label=\"Se incarca lista de dispozitive\" />;\n  }\n  const isAdminCheckbox = (\n    <Checkbox\n      checked={isAdmin}\n      onChange={({ target }) => {\n        const userRef = firestoreDB.collection('emails').doc(email);\n        userRef.update({\n          isAdmin: target.checked,\n        });\n      }}\n    />\n  );\n\n  return (\n    <div style={{ display: 'flex', flexDirection: 'column' }}>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <Typography style={{ margin: '0 16px' }}>\n          {`Email: '${email}'`}\n        </Typography>\n        <FormControlLabel control={isAdminCheckbox} label=\"Administrator\" />\n      </div>\n\n      <Devices\n        selectionLabel=\"Acces permis\"\n        devices={devices}\n        selected={[1,2,3]\n          .map(({ id }) => id)}\n        setSelected={(id, state) => {\n          const deviceRef = firestoreDB.collection('devices').doc(id);\n          deviceRef.update({\n            admins: (state\n              ? firebase.firestore.FieldValue.arrayUnion\n              : firebase.firestore.FieldValue.arrayRemove)(`email:${email}`),\n          });\n        }}\n      />\n    </div>\n  );\n};\n","import { Route, Switch, useParams } from 'react-router-dom';\nimport * as React from 'react';\nimport Users from './users';\nimport User from './user';\n\nconst MountedUser = () => {\n  const { email } = useParams();\n  return <User email={email} />;\n};\n// alert(\"users\")\nexport default ({ match }) => {\n  return (\n    <Switch>\n      <Route path={`${match.url}/:email`} component={MountedUser} />\n      <Route path={`${match.url}/`} exact component={Users} />\n    </Switch>\n  );\n};\n\n \n","import React from 'react';\r\nimport GoogleButton from 'react-google-button';\r\nimport firebase from 'firebase'\r\nimport { AppBar, Toolbar, Button, Typography, Avatar, MenuItem, Menu, IconButton, } from '@material-ui/core';\r\nimport { BrowserRouter, HashRouter, Route, Switch, Link, } from 'react-router-dom';\r\nimport { Home, SupervisorAccount } from '@material-ui/icons';\r\nimport Login from './login';\r\nimport DevicesContainer from './devices-container';\r\n// import Device from './device/index.jsx';\r\nimport Device from './NewDevice';\r\n\r\nimport MissingPermission from './missing-permission';\r\n\r\nimport Users from './users';\r\nimport axios from 'axios';\r\n// import WebPushStatus from './web-push-status';\r\nconst Router = BrowserRouter\r\n\r\nclass DeviceList extends React.Component {\r\n componentDidMount = () => {\r\n }\r\n  render() {\r\n    return (\r\n      <Router>\r\n        <div style={{ display: 'flex', flexDirection: 'column' }}>\r\n        <AppBar position=\"static\">\r\n          <Toolbar>\r\n            <IconButton component={Link} to=\"/\" edge=\"start\" color=\"inherit\">\r\n              <Home />\r\n            </IconButton>\r\n\r\n            {true ? (\r\n              <IconButton\r\n                component={Link}\r\n                to=\"/users\"\r\n                edge=\"start\"\r\n                color=\"inherit\"\r\n              >\r\n                <SupervisorAccount />\r\n              </IconButton>\r\n            ) : null}\r\n\r\n            <Typography variant=\"h6\" style={{ flex: 1 }}>\r\n              {\"Awesome App\"}\r\n            </Typography>\r\n            <Button\r\n              color=\"inherit\"\r\n              onClick={({ currentTarget }) => {\r\n                //   setMenuTarget(currentTarget);\r\n              }}\r\n            >\r\n              {/* {userData.displayName} */}\r\n              <Avatar\r\n                //   src={userData.photoURL}\r\n                style={{\r\n                  margin: 10,\r\n                  width: 24,\r\n                  height: 24,\r\n                }}\r\n              />\r\n            </Button>\r\n          </Toolbar>\r\n          {/* <WebPushStatus email={'princehamzi.mine@gmail.com'} /> */}\r\n        </AppBar>\r\n\r\n\r\n        <Menu\r\n          // anchorEl={menuTarget}\r\n          keepMounted\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          getContentAnchorEl={null}\r\n          // open={menuTarget !== null}\r\n          open={false}\r\n        // onClose={() => setMenuTarget(null)}\r\n        >\r\n          <MenuItem\r\n            onClick={() => {\r\n              // setMenuTarget(null);\r\n              // firebaseApp.logout();\r\n            }}\r\n          >\r\n            Log out\r\n          </MenuItem>\r\n        </Menu>\r\n\r\n\r\n\r\n        {false ? (\r\n            <MissingPermission />\r\n          ) : (\r\n            <Switch>\r\n              <Route path=\"/\" exact component={DevicesContainer} />\r\n              <Route path=\"/users\" component={Users} />\r\n              <Route\r\n                path=\"/device/:id\"\r\n                component={({ match }) => <Device id={match.params.id} />}\r\n              />\r\n              <Route component={() => '404'} />\r\n            </Switch>\r\n          )}\r\n\r\n\r\n\r\n      </div>\r\n      </Router>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport default DeviceList","import Login from './login'\nimport DeviceList from './DeviceList'\nimport './App.css';\n\nconst App = () => {\n\n  // check ogin session\n  return (\n    <div className=\"App\">\n      {/* <Login /> */}\n      <DeviceList />\n    </div>\n  );\n}\n\nexport default App;\n","import { Workbox } from 'workbox-window';\nimport { IS_PRODUCTION, VAPID_PUBLIC_KEY } from './config';\n\nconst promptReload = () => {\n  if (!IS_PRODUCTION) {\n    return;\n  }\n  if (\n    window.confirm(\n      `Se ruleaza o versiune veche a aplicatiei. Apasa OK pentru update.`\n    )\n  ) {\n    window.location.reload();\n  }\n};\nexport default (async () => {\n  if (IS_PRODUCTION && 'serviceWorker' in navigator) {\n    const workbox = new Workbox('/service-worker.js');\n    workbox.addEventListener('installed', ({ isUpdate }) => {\n      if (isUpdate) {\n        promptReload();\n      }\n    });\n    workbox.addEventListener('externalactivated', () => {\n      promptReload();\n    });\n    return await workbox.register();\n  }\n  return null;\n})();\n","export default () => 'test';\n","import { firebase } from '@firebase/app';\nimport '@firebase/auth';\nimport '@firebase/firestore';\nimport { FIREBASE_CONFIG, IS_PRODUCTION, DISABLE_NETWORK } from './config';\n\nlet firebaseApp = null;\nexport default async () => {\n  if (firebaseApp !== null) {\n    return firebaseApp;\n  }\n  let firebaseConfig;\n  if (IS_PRODUCTION && window.location.protocol === 'https:') {\n    // Only works if hosted on Firebase\n    // https://stackoverflow.com/questions/40856179/custom-authdomain-in-firebase\n    firebaseConfig = {\n      ...FIREBASE_CONFIG,\n      authDomain: window.location.hostname,\n    };\n  } else {\n    firebaseConfig = FIREBASE_CONFIG;\n  }\n\n  firebaseApp = firebase.initializeApp(firebaseConfig);\n  const firestoreDB = firebaseApp.firestore();\n  await firestoreDB.enablePersistence({ synchronizeTabs: true });\n  if (DISABLE_NETWORK) {\n    await firestoreDB.disableNetwork();\n  }\n  if (!IS_PRODUCTION) {\n    window.firebase = firebase;\n    window.app = firebaseApp;\n    window.firestoreDB = firestoreDB;\n  }\n  return firebase;\n};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import './index.css';\nimport App from './App';\n// import reportWebVitals from './reportWebVitals';\nimport './register-service-worker';\nimport 'react-hot-loader';\nimport { hot } from 'react-hot-loader/root';\n// import ReactDOM from '@hot-loader/react-dom';\nimport { Provider } from 'react-redux';\nimport { ReactReduxFirebaseProvider } from 'react-redux-firebase';\nimport { createFirestoreInstance } from 'redux-firestore';\nimport { firebase } from '@firebase/app';\nimport { database } from '@firebase/database';\n\nimport createStore from './store';\nimport { IS_PRODUCTION, VERSION } from './config';\nimport connectFirebase from './firebase';\n\nfunction getAppContainer() {\n  const currentContainer = window.document.getElementById('app');\n  if (currentContainer !== null) {\n    return currentContainer;\n  }\n  const newContainer = document.createElement('div');\n  newContainer.setAttribute('id', 'app');\n  document.body.appendChild(newContainer);\n  return newContainer;\n}\n\n\nconst globalStyle = `\nhtml, body, #app{\n  height: 100%;\n  width: 100%;\n  margin: 0;\n  display: flex;\n}\n#app > * {\n  min-height: 100%;\n  width: 100%;\n}\n`;\n\nconnectFirebase();\n\nfirebase.database().ref('/connect').set({connect:true})\n\n\nconst store = createStore();\n\nconst Main = hot(() => (\n  <Provider store={store}>\n    <ReactReduxFirebaseProvider\n      firebase={firebase}\n      config={{\n        enableLogging: !IS_PRODUCTION,\n      }}\n      createFirestoreInstance={createFirestoreInstance}\n      dispatch={store.dispatch}\n    >\n      <>\n        <App />\n        <style dangerouslySetInnerHTML={{ __html: globalStyle }} />\n      </>\n    </ReactReduxFirebaseProvider>\n  </Provider>\n));\n\nReactDOM.render(<Main />, getAppContainer());\n\nwindow.version = VERSION;\n\n\n// ReactDOM.render(\n//   <React.StrictMode>\n//     <App />\n//   </React.StrictMode>,\n//   document.getElementById('root')\n// );\n\n// reportWebVitals();\n","import { createStore, combineReducers } from 'redux';\n// import { composeWithDevTools } from 'redux-devtools-extension/developmentOnly';\nimport { firebaseReducer } from 'react-redux-firebase';\nimport { reduxFirestore, firestoreReducer } from 'redux-firestore';\nimport { firebase } from '@firebase/app';\nimport appReducer from './reducer';\nimport { IS_PRODUCTION } from './config';\n\nexport default () => {\n  const rootReducer = combineReducers({\n    firebase: firebaseReducer,\n    app: appReducer,\n    firestore: firestoreReducer,\n  });\n\n  const store = createStore(\n    rootReducer,\n    // composeWithDevTools(reduxFirestore(firebase))\n  );\n  if (!IS_PRODUCTION) {\n    window.store = store;\n  }\n  return store;\n};\n"],"sourceRoot":""}